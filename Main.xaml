<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="654,1258" sap2010:WorkflowViewState.IdRef="Main_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Diagnostics;assembly=System" xmlns:sd1="clr-namespace:System.Data;assembly=System.Data" xmlns:si="clr-namespace:System.IO;assembly=mscorlib" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="28">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Net</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Net.NetworkInformation</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="28">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.PDF</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Flowchart sap2010:Annotation.AnnotationText="RobotDoc - robot urcare documente PDF in Ecris. Activitatile sau secventele sunt comentate, de regula, numai la prima lor aparitie dupa Start." DisplayName="Main Flowchart" sap:VirtualizedContainerService.HintSize="634,678" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" Name="NrDosar" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)[]" Name="ConfigInstante" />
      <Variable x:TypeArguments="sd1:DataTable" Name="TabeldinDB" />
      <Variable x:TypeArguments="x:String" Name="idDosar" />
      <Variable x:TypeArguments="x:String" Name="idDocument" />
      <Variable x:TypeArguments="s:String[]" Name="filesList" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="ConfigGenerale" />
      <Variable x:TypeArguments="x:String" Name="fisierEroare" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">330,40 461,40 461,135.04</av:PointCollection>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID24</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID21" sap2010:WorkflowViewState.IdRef="FlowStep_1132">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">361,336.04</av:Point>
          <av:Size x:Key="ShapeSize">200,93</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">461,429.04 461,538.5 390,538.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Urca fisierele in Ecris pentru fiecare instanta la rand" DisplayName="For Each instanta" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="ForEach`1_97" Values="[ConfigInstante]">
        <ui:ForEach.Body>
          <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
            </ActivityAction.Argument>
            <Flowchart DisplayName="Proceseaza instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Flowchart_76">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID20</x:Reference>
              </Flowchart.StartNode>
              <FlowStep x:Name="__ReferenceID19" sap2010:WorkflowViewState.IdRef="FlowStep_1129">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">200,384.5</av:Point>
                    <av:Size x:Key="ShapeSize">200,108</av:Size>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <TryCatch sap2010:Annotation.AnnotationText="Urca in Ecris documentele gasite pentru instanta respectiva" DisplayName="Documente in Ecris" sap:VirtualizedContainerService.HintSize="438,324" sap2010:WorkflowViewState.IdRef="TryCatch_233">
                  <TryCatch.Variables>
                    <Variable x:TypeArguments="x:String" Name="Diez" />
                    <Variable x:TypeArguments="x:String" Name="DataDoc" />
                    <Variable x:TypeArguments="x:String" Name="ScanPartial" />
                    <Variable x:TypeArguments="x:String" Name="InterogareSQL" />
                    <Variable x:TypeArguments="x:Int32" Name="contorAtasamente" />
                    <Variable x:TypeArguments="si:FileStream" Name="fs" />
                    <Variable x:TypeArguments="x:Boolean" Name="fileLocked" />
                    <Variable x:TypeArguments="x:Int32" Name="contor" />
                  </TryCatch.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence DisplayName="Documente in Ecris" sap:VirtualizedContainerService.HintSize="554,4713" sap2010:WorkflowViewState.IdRef="Sequence_1414">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If Condition="[instanta(&quot;ExistaScanarePrinEmail&quot;) = &quot;da&quot;]" DisplayName="Verifica email cu documente scanate de grefierii de sedinta" sap:VirtualizedContainerService.HintSize="512,51" sap2010:WorkflowViewState.IdRef="If_501">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <TryCatch DisplayName="Try verifica email cu documente scanate de grefierii de sedinta" sap:VirtualizedContainerService.HintSize="434,556" sap2010:WorkflowViewState.IdRef="TryCatch_260">
                            <TryCatch.Variables>
                              <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="messages" />
                            </TryCatch.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch.Try>
                              <Sequence DisplayName="Verifica email cu documente scanate de grefierii de sedinta" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1541">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="340,60" sap2010:WorkflowViewState.IdRef="Assign_1329">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)">[messages]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="scg:List(snm:MailMessage)">[new List(of System.Net.Mail.MailMessage)]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <ui:GetIMAPMailMessages TimeoutMS="{x:Null}" Top="{x:Null}" sap2010:Annotation.AnnotationText="Cauta mesajele email in serverul IMAP" DeleteMessages="False" DisplayName="Get IMAP mail messages" Email="[instanta(&quot;UsernameEmailGrefieri&quot;)]" EnableSSL="True" sap:VirtualizedContainerService.HintSize="340,64" sap2010:WorkflowViewState.IdRef="GetIMAPMailMessages_1" MailFolder="Inbox" MarkAsRead="True" Messages="[messages]" OnlyUnreadMessages="True" Password="[instanta(&quot;PasswordEmailGrefieri&quot;)]" Port="[Convert.ToInt32(instanta(&quot;PortEmailGrefieri&quot;).Trim)]" SecureConnection="None" Server="[instanta(&quot;IPEmailGrefieri&quot;)]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:GetIMAPMailMessages>
                                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="340,1595" sap2010:WorkflowViewState.IdRef="ForEach`1_108" Values="[messages]">
                                  <ui:ForEach.Body>
                                    <ActivityAction x:TypeArguments="snm:MailMessage">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="mail" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="304,1461" sap2010:WorkflowViewState.IdRef="Sequence_1540">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If sap2010:Annotation.AnnotationText="Ignora mesajul email daca nu are atasamente tip PDF (eroare grefier). Pentru a face verificarea, se foloseste LINQ." Condition="[mail.Attachments.Where(Function (x) Path.GetExtension(x.Name).ToLower=&quot;.pdf&quot;).Count = 0]" DisplayName="Daca emailul nu are atasamente PDF" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="If_504">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_80" />
                                          </If.Then>
                                        </If>
                                        <Assign sap2010:Annotation.AnnotationText="Inlocuieste / cu -, caracter permis in numele de fisier. Se corecteaza si alte erori uzuale" DisplayName="Corecteaza erori user posibile" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_1330">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[mail.Subject]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[mail.Subject.ToLower.Replace(" ", "").Replace("*", "x").Replace("/", "-").Replace("\", "-").Replace("o", "0").Replace(",", ".").Replace(".pdf", "").Trim("."c)]</InArgument>
                                          </Assign.Value>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </Assign>
                                        <Assign sap2010:Annotation.AnnotationText="Subiectul emailului, care va fi numele fisierului si contine numarul de dosar, poate contine caractere care sunt interzise in numele de fisiere si atunci aceste caractere sunt eliminate" DisplayName="Corecteaza caractere invalide" sap:VirtualizedContainerService.HintSize="262,147" sap2010:WorkflowViewState.IdRef="Assign_1331">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[mail.Subject]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[Path.GetInvalidFileNameChars.Aggregate(mail.Subject, Function(current, c) current.Replace(c.ToString, ""))]</InArgument>
                                          </Assign.Value>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </Assign>
                                        <If sap2010:Annotation.AnnotationText="Daca nu exista subiect, atasamentele vor fi salvate direct in FolderErori (eroare grefier)" Condition="[System.String.IsNullOrWhiteSpace(mail.Subject)]" DisplayName="Daca emailul nu are subiect" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="If_499">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence sap:VirtualizedContainerService.HintSize="376,241" sap2010:WorkflowViewState.IdRef="Sequence_1546">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:SaveMailAttachments Attachments="{x:Null}" DisplayName="Save Attachments" Filter="(.pdf|.PDF)" FolderPath="[instanta(&quot;FolderErori&quot;)]" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="SaveMailAttachments_1" Message="[mail]" />
                                              <ui:Continue sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Continue_77" />
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                        <If sap2010:Annotation.AnnotationText="Adauga terminatia _GREFIER in numele fisierului pentru a il deosebi de fisierele salvate de registratura. Dca numele fiserului exista deja, adauga ora si minutul salvarii pentru a crea un nume diferit si a evita suprascrierea" Condition="[System.IO.File.Exists(instanta(&quot;FolderDocumente&quot;)+&quot;\&quot;+mail.Subject+&quot;_GREFIER.pdf&quot;)]" DisplayName="Daca numele fisier exista deja" sap:VirtualizedContainerService.HintSize="262,183" sap2010:WorkflowViewState.IdRef="If_500">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1327">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[mail.Subject]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[mail.Subject+"_GREFIER_ora_"+DateTime.Now.ToString("HH-mm")]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </If.Then>
                                          <If.Else>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1332">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[mail.Subject]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[mail.Subject+"_GREFIER"]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </If.Else>
                                        </If>
                                        <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1328">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="si:FileStream">[file.Create(instanta("FolderDocumente")+"\"+mail.Subject+".pdf")]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <InvokeMethod sap2010:Annotation.AnnotationText="Salveaza cu numele de mai sus primul fisier PDF atasat email-ului, daca, din eroare, sunt mai multe atasamente" DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,204" sap2010:WorkflowViewState.IdRef="InvokeMethod_57" MethodName="CopyTo">
                                          <InvokeMethod.TargetObject>
                                            <InArgument x:TypeArguments="si:Stream">[mail.Attachments(mail.Attachments.IndexOf(mail.Attachments.Where(Function (x) Path.GetExtension(x.Name).ToLower = ".pdf").First)).ContentStream]</InArgument>
                                          </InvokeMethod.TargetObject>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                        </InvokeMethod>
                                        <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_58" MethodName="Close">
                                          <InvokeMethod.TargetObject>
                                            <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                          </InvokeMethod.TargetObject>
                                        </InvokeMethod>
                                      </Sequence>
                                    </ActivityAction>
                                  </ui:ForEach.Body>
                                </ui:ForEach>
                              </Sequence>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,394" sap2010:WorkflowViewState.IdRef="Catch`1_269">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="242,325" sap2010:WorkflowViewState.IdRef="Sequence_1545">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_213" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;)+&quot;] Nu m-am putut conecta la contul e-mail IMAP cu documentele scanate de grefierii de sedinta. EROARE&quot;]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:AppendLine>
                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_293">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_284" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                          <ui:BrowserScope.Body>
                                            <ActivityAction x:TypeArguments="x:Object">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1713">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_25" />
                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_707" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                  <ui:TypeInto.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                  </ui:TypeInto.Target>
                                                </ui:TypeInto>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:BrowserScope.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:BrowserScope>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_302">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_282" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                              <ui:OpenBrowser.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1714">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_708" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:OpenBrowser.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:OpenBrowser>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,183" sap2010:WorkflowViewState.IdRef="TryCatch_317">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_17" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', '', 14, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                          <ui:ExecuteNonQuery.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                          </ui:ExecuteNonQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteNonQuery>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_326">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                  </Sequence>
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                          </TryCatch>
                        </If.Then>
                      </If>
                      <Assign sap2010:Annotation.AnnotationText="Reseteaza variabila pentru a fi folosita in loguri si emailuri daca la prelucrarea fisierului curent apare o eroare." sap:VirtualizedContainerService.HintSize="512,117" sap2010:WorkflowViewState.IdRef="Assign_1393">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" Value="" />
                          </InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                      <Assign DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="512,60" sap2010:WorkflowViewState.IdRef="Assign_1211">
                        <Assign.To>
                          <OutArgument x:TypeArguments="s:String[]">[filesList]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="s:String[]">[new string(){}]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap2010:Annotation.AnnotationText="Listeaza intr-un vector (array) continutul (fisierele) directorului FolderDocumente" sap:VirtualizedContainerService.HintSize="512,102" sap2010:WorkflowViewState.IdRef="Assign_1212">
                        <Assign.To>
                          <OutArgument x:TypeArguments="s:String[]">[filesList]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(instanta("FolderDocumente"), "*.pdf")]</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                      <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For each" sap:VirtualizedContainerService.HintSize="512,4131" sap2010:WorkflowViewState.IdRef="ForEach`1_94" Values="[filesList]">
                        <ui:ForEach.Body>
                          <ActivityAction x:TypeArguments="x:String">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="304,2061" sap2010:WorkflowViewState.IdRef="Sequence_1413">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If sap2010:Annotation.AnnotationText="Este posibil ca, cat timp robotul este ocupat cu alte fisiere, sa se stearga un fisier care asteapta la rand. In acest caz, numele fisierului ramane in fileList si ar putea da eroare file not found." Condition="[System.IO.File.Exists(file)]" DisplayName="Verifica daca mai exista documentul" sap:VirtualizedContainerService.HintSize="262,168" sap2010:WorkflowViewState.IdRef="If_524">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Else>
                                  <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_83" />
                                </If.Else>
                              </If>
                              <Sequence DisplayName="Verifica ca fisierul e inchis si e document" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_1647">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="x:String" Name="httpmessage" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1392">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[file]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <If sap2010:Annotation.AnnotationText="RTIV de la Panasonic nu tine un handle deschis pe fisierul PDF si atunci este posibil ca robotul sa il urce in Ecris inainte ca grefierul sa fi terminat de scanat. De aceea, robotul ia in analiza un fisier dupa un anumit numar de secunde (stabilit pentru fiecare instanta) de la ultima scriere in el (DateModified), presupunand ca grefierul a terminat scanarea in acest timp" Condition="[(DateTime.Now - new System.IO.FileInfo(file).LastWriteTime).TotalSeconds &lt;= Convert.ToInt32(instanta(&quot;TimpAsteptareDoc&quot;))]" DisplayName="Verifica ca documentul e mai vechi de x secunde" sap:VirtualizedContainerService.HintSize="262,273" sap2010:WorkflowViewState.IdRef="If_434">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_64" />
                                  </If.Then>
                                </If>
                                <TryCatch sap2010:Annotation.AnnotationText="Fisierul PDF poate fi deschis de alt program decat RTIV, program care tine handle deschis pe fisier (ex. Acrobat Reader). Robotul incearca sa deschida fisierul si, daca fisierul este deschis de alt program, OS va da eroare. Robotul va captura eroarea si va sari peste fisier, asteptand o deblocare ulterioara " DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="262,228" sap2010:WorkflowViewState.IdRef="TryCatch_279">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <TryCatch.Try>
                                    <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="304,324" sap2010:WorkflowViewState.IdRef="Sequence_1646">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1390">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(file, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_60" MethodName="Close">
                                        <InvokeMethod.TargetObject>
                                          <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                        </InvokeMethod.TargetObject>
                                      </InvokeMethod>
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_288">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_93" />
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                                <If sap2010:Annotation.AnnotationText="Daca este activata optiunea, robotul intreaba prin HTTP serverul cu reteaua neur(on)ala CitNet daca fisierul este citatie sau document. Nu are relevanta pentru prezentul robot (pentru celalalt robot are), este doar de test.&#xA;Pentru instantele la care arhiva scaneaza documentele si citatiile in acelasi folder, robotul face diferenta intre cele 2 categorii dupa cum numele fiserului respecta un pattern (RegEx) de tipul (1+cifre)-(1+cifre)-(1+cifre). In loc de -, se poate folosi _. Atentie, unele instante salveaza fisierele citatii sub forma 11-10-2019.pdf si atunci robotul foloseste regex lookahead pentru a evita sa le considere documente. Practica trebuie eliminata in randul grefierilor, deoarece poate da erori (de ex. la dosarele de la instantele cu indicativul 10, 11 sau 12).&#xA;Daca fisierul nu are regex de document, robotul il ignora (presupune ca este cu dovezi de citare sau comunicare si il lasa pentru a fi prelucrat de celalalt robot)." Condition="[ConfigGenerale(&quot;FolosesteReteaneurala&quot;) = &quot;da&quot;]" DisplayName="Reteaua neurala CitNet" sap:VirtualizedContainerService.HintSize="262,573" sap2010:WorkflowViewState.IdRef="If_570">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence DisplayName="Reteaua neurala CitNet" sap:VirtualizedContainerService.HintSize="526,462" sap2010:WorkflowViewState.IdRef="Sequence_1751">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_1406">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[httpmessage]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[file]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:HttpClient Body="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseHeaders="{x:Null}" StatusCode="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" BodyFormat="application/xml" ClientCertificate="[Nothing]" ClientCertificatePassword="[Nothing]" ContinueOnError="True" DisplayName="Verifica cu CitNet prin HTTP Request" EndPoint="[&quot;http://&quot;+ConfigGenerale(&quot;IPreteaneurala&quot;)+&quot;:&quot;+ConfigGenerale(&quot;Portreteaneurala&quot;)+&quot;/query&quot;]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="HttpClient_2" Method="GET" Result="[httpmessage]" TimeoutMS="6000">
                                        <ui:HttpClient.Attachments>
                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                        </ui:HttpClient.Attachments>
                                        <ui:HttpClient.Cookies>
                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                        </ui:HttpClient.Cookies>
                                        <ui:HttpClient.Headers>
                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                        </ui:HttpClient.Headers>
                                        <ui:HttpClient.Parameters>
                                          <InArgument x:TypeArguments="x:String" x:Key="robot">[ConfigGenerale("IDptreteaneurala")]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="idinstanta">[instanta("id")]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="pathfile">[httpmessage]</InArgument>
                                        </ui:HttpClient.Parameters>
                                        <ui:HttpClient.UrlSegments>
                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                        </ui:HttpClient.UrlSegments>
                                      </ui:HttpClient>
                                      <If Condition="[Not System.Text.RegularExpressions.Regex.Match(file.Replace(&quot; &quot;, &quot;&quot;), &quot;\d+(-|_)(?!1([0-2])-)[1-9]\d*(-|_).+&quot;).Success]" DisplayName="Verificare daca PDF-ul e document cu numar dosar" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_566">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_98" />
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </If.Then>
                                </If>
                              </Sequence>
                              <If sap2010:Annotation.AnnotationText="In versiunile de Ecris din timpul dezvoltarii robotului, am descoperit ca Ecris nu accepta fisierul PDF daca  extensia lui este scrisa cu litere mari (bug Ecris)." Condition="[Path.GetExtension(file) &lt;&gt; &quot;.pdf&quot;]" DisplayName="Daca extensia contine litere mari - blocheaza Ecris" sap:VirtualizedContainerService.HintSize="262,153" sap2010:WorkflowViewState.IdRef="If_557">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderDocumente&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+Path.GetExtension(file).ToLower]" DisplayName="Rename File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_127" Overwrite="True" Path="[file]" />
                                </If.Then>
                              </If>
                              <If Condition="[new System.IO.FileInfo(file).Length &gt;= cint(instanta(&quot;UploadMax&quot;))]" DisplayName="Split pe bucati daca documentul e prea mare" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_541">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="376,885" sap2010:WorkflowViewState.IdRef="Sequence_1645">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:StartProcess WorkingDirectory="{x:Null}" sap2010:Annotation.AnnotationText="Aplictia sejda foloseste Java pentru a splita in bucati mai mici fisierele mai mari decat limita maxima de upload pentru Ecris. Aplicatia adauga terminatia p1, p2, p3 la numele bucatilor rezultate. Pentru ca aplicatia sa functioneze, folderul bin al java din Program Files trebuie introdus in variabila PATH de sistem (atentie, nu de user), vezi control panel, system, advanced system settings, environment variables, system variables." Arguments="[&quot; splitbysize -s &quot;+instanta(&quot;UploadMax&quot;)+&quot; -j overwrite -p [BASENAME]p[FILENUMBER] -f &quot;&quot;&quot;+file+&quot;&quot;&quot; -o &quot;&quot;&quot;+instanta(&quot;FolderDocumente&quot;)+&quot;&quot;]" DisplayName="Split PDF cu aplicatia &quot;sejda&quot;" FileName="[ConfigGenerale(&quot;CaleSejda&quot;)]" sap:VirtualizedContainerService.HintSize="334,234" sap2010:WorkflowViewState.IdRef="StartProcess_1">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:StartProcess>
                                    <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Delay_75" />
                                    <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="Asteapta inchidere &quot;sejda&quot;" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ForEach`1_110" Values="[System.Diagnostics.Process.GetProcessesByName(&quot;java&quot;)]">
                                      <ui:ForEach.Body>
                                        <ActivityAction x:TypeArguments="sd:Process">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                                          </ActivityAction.Argument>
                                          <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="238,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_64" MethodName="WaitForExit">
                                            <InvokeMethod.TargetObject>
                                              <InArgument x:TypeArguments="sd:Process">[process]</InArgument>
                                            </InvokeMethod.TargetObject>
                                          </InvokeMethod>
                                        </ActivityAction>
                                      </ui:ForEach.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEach>
                                    <Sequence sap2010:Annotation.AnnotationText="Verifica daca fisierul nu a ramas blocat de sejda/java sau deschis de alt program. Robotul incearca sa il acceseze si captureaza eventualele erori. Pentru a evita bucle infinite, dupa 100 accesari (aprox. 100 sec), trece mai departe" DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="334,213" sap2010:WorkflowViewState.IdRef="Sequence_1759">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_1417">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <DoWhile DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="484,913" sap2010:WorkflowViewState.IdRef="DoWhile_4">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <DoWhile.Condition>[fileLocked = True And contor &lt; 100]</DoWhile.Condition>
                                        <TryCatch DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="438,751" sap2010:WorkflowViewState.IdRef="TryCatch_312">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="304,524" sap2010:WorkflowViewState.IdRef="Sequence_1757">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1418">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1419">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[contor + 1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1420">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(file, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_67" MethodName="Close">
                                                <InvokeMethod.TargetObject>
                                                  <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                                </InvokeMethod.TargetObject>
                                              </InvokeMethod>
                                            </Sequence>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_321">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="526,359" sap2010:WorkflowViewState.IdRef="Sequence_1758">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If Condition="[exception.Message.Contains(&quot;being used by another process&quot;)]" DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_569">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1421">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </If.Then>
                                                  </If>
                                                  <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Delay_79" />
                                                </Sequence>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                      </DoWhile>
                                    </Sequence>
                                    <If Condition="[System.IO.File.Exists(instanta(&quot;FolderDocumente&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;p1&quot;+Path.GetExtension(file))]" DisplayName="Move file PDF, daca a reusit splitarea" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_550">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="Daca a reusit splitarea" sap:VirtualizedContainerService.HintSize="242,416" sap2010:WorkflowViewState.IdRef="Sequence_1693">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If Condition="[System.IO.File.Exists(instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_540">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Prelucrate redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_119" Overwrite="True" Path="[file]" />
                                            </If.Then>
                                            <If.Else>
                                              <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_120" Overwrite="True" Path="[file]" />
                                            </If.Else>
                                          </If>
                                          <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_229" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ file + &quot; - splitat in mai multe parti cu ajutorul aplicatiei Sejda&quot;]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:AppendLine>
                                          <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_294">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_285" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                <ui:BrowserScope.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1715">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_26" />
                                                      <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_709" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                        <ui:TypeInto.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                        </ui:TypeInto.Target>
                                                      </ui:TypeInto>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:BrowserScope.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:BrowserScope>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_303">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                  <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_283" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                    <ui:OpenBrowser.Body>
                                                      <ActivityAction x:TypeArguments="x:Object">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1716">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_710" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                            <ui:TypeInto.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                            </ui:TypeInto.Target>
                                                          </ui:TypeInto>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:OpenBrowser.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:OpenBrowser>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_318">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_24" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', '', 12, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                <ui:ExecuteNonQuery.Parameters>
                                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                </ui:ExecuteNonQuery.Parameters>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExecuteNonQuery>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_327">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                        </Sequence>
                                      </If.Then>
                                      <If.Else>
                                        <Sequence DisplayName="Daca nu a reusit splitarea" sap:VirtualizedContainerService.HintSize="242,325" sap2010:WorkflowViewState.IdRef="Sequence_1697">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_230" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ file + &quot; - Eroare la splitare cu aplicatia Sejda. Voi incerca din nou mai tarziu - EROARE&quot;]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:AppendLine>
                                          <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_295">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_286" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                <ui:BrowserScope.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1717">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_27" />
                                                      <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_711" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                        <ui:TypeInto.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                        </ui:TypeInto.Target>
                                                      </ui:TypeInto>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:BrowserScope.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:BrowserScope>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_304">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                  <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_284" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                    <ui:OpenBrowser.Body>
                                                      <ActivityAction x:TypeArguments="x:Object">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1718">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_712" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                            <ui:TypeInto.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                            </ui:TypeInto.Target>
                                                          </ui:TypeInto>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:OpenBrowser.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:OpenBrowser>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_319">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_25" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', '', 17, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                <ui:ExecuteNonQuery.Parameters>
                                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                </ui:ExecuteNonQuery.Parameters>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExecuteNonQuery>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_328">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                        </Sequence>
                                      </If.Else>
                                    </If>
                                    <ui:Continue sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Continue_92" />
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Flowchart sap2010:Annotation.AnnotationText="Afla NrDosar si idDocument" DisplayName="Afla inf necesare pt Document" sap:VirtualizedContainerService.HintSize="774,1982" sap2010:WorkflowViewState.IdRef="Flowchart_77">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <av:Point x:Key="ShapeLocation">330,2.5</av:Point>
                                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">360,77.5 360,124</av:PointCollection>
                                    <x:Double x:Key="Width">740.5</x:Double>
                                    <x:Double x:Key="Height">1915</x:Double>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Flowchart.StartNode>
                                  <x:Reference>__ReferenceID18</x:Reference>
                                </Flowchart.StartNode>
                                <FlowStep x:Name="__ReferenceID9" sap2010:WorkflowViewState.IdRef="FlowStep_1179">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">228.895,227.5</av:Point>
                                      <av:Size x:Key="ShapeSize">262,117</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">359.895,344.5 359.895,377.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap2010:Annotation.AnnotationText="Extrage NrDosar din numele fisierului, inlaturand spatiile si erorile de tehnoredactare" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_1357">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[Path.GetFileNameWithoutExtension(file).Split({"_mutat", "_GREFIER"}, StringSplitOptions.None)(0).ToLower.Replace("cit", "").Replace("doc", "").Replace("-", "/").Replace("_", "/").Replace("x", "*").Replace("o", "0").Replace(",", ".").Replace(" ", "").Replace("'", "").Replace("""", "").Replace("..", ".").Replace("/*", "*").Replace("/#", "#").Replace("/d", "d").Replace("#d", "d").Replace("/p", "p").Replace("#p", "p").Trim("."c)]</InArgument>
                                    </Assign.Value>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </Assign>
                                  <FlowStep.Next>
                                    <FlowStep x:Name="__ReferenceID10" sap2010:WorkflowViewState.IdRef="FlowStep_1187">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">259.895,377.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">359.895,428.5 359.895,468.5</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[NrDosar.Contains(&quot;p&quot;)]" DisplayName="Afla daca este scan partial" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_509">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1372">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[ScanPartial]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[NrDosar.Substring(NrDosar.LastIndexOf("p"), System.Text.RegularExpressions.Regex.Match(NrDosar.Substring(NrDosar.LastIndexOf("p")), "[^0-9p]|$").Index)]</InArgument>
                                            </Assign.Value>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Assign>
                                        </If.Then>
                                      </If>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID11" sap2010:WorkflowViewState.IdRef="FlowStep_1186">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">259.895,468.5</av:Point>
                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">359.895,519.5 359.895,559.5</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If Condition="[NrDosar.Contains(&quot;#&quot;)]" DisplayName="Afla Diez (daca exista)" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_510">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1373">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[Diez]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[NrDosar.Substring(NrDosar.LastIndexOf("#"), System.Text.RegularExpressions.Regex.Match(NrDosar.Substring(NrDosar.LastIndexOf("#")), "[^0-9#]|$").Index)]</InArgument>
                                                </Assign.Value>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </Assign>
                                            </If.Then>
                                          </If>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID12" sap2010:WorkflowViewState.IdRef="FlowStep_1185">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">259.895,559.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">359.895,610.5 359.895,658.54</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If Condition="[NrDosar.Contains(&quot;d&quot;)]" DisplayName="Afla DataDoc (daca exista)" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_511">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1374">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[DataDoc]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[NrDosar.Substring(NrDosar.LastIndexOf("d")+1, System.Text.RegularExpressions.Regex.Match(NrDosar.Substring(NrDosar.LastIndexOf("d")+1), "[^0-9d]|$").Index).Trim]</InArgument>
                                                    </Assign.Value>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </Assign>
                                                </If.Then>
                                              </If>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID17" sap2010:WorkflowViewState.IdRef="FlowStep_1188">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">259.895,658.54</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">359.895,709.54 359.895,739.54 360,739.54 360,754.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If Condition="[System.Text.RegularExpressions.Regex.Match(NrDosar, &quot;[#dp]&quot;) is Match.Empty]" DisplayName="Afla NrDosar curat" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_516">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Else>
                                                      <Assign DisplayName="Assign" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1383">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[NrDosar.Remove(System.Text.RegularExpressions.Regex.Match(NrDosar, "[#dp]").Index)]</InArgument>
                                                        </Assign.Value>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Assign>
                                                    </If.Else>
                                                  </If>
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID8" sap2010:WorkflowViewState.IdRef="FlowStep_1171">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">260,754.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">360,820.5 360,855.5</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Sequence DisplayName="Inlatura erori user posibile" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1551">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If Condition="[Diez = &quot;#&quot;]" DisplayName="Diez - Inlatura erori user posibile" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_507">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1360">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[Diez]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">
                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                </InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Then>
                                                        </If>
                                                        <If Condition="[DataDoc = &quot;d&quot;]" DisplayName="DataDoc - Inlatura erori user posibile" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_508">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1361">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[DataDoc]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">
                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                </InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Then>
                                                        </If>
                                                      </Sequence>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID6" sap2010:WorkflowViewState.IdRef="FlowStep_1169">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">260,855.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,93</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">360,948.5 360,986.5</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Afla daca NrDosar exista in Ecris" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="ExecuteQuery_222" ProviderName="System.Data.SqlClient" Sql="SELECT id_dosar FROM Dosar WHERE numar_national=@NrDosar" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                            <ui:ExecuteQuery.Parameters>
                                                              <InArgument x:TypeArguments="x:String" x:Key="NrDosar">[NrDosar]</InArgument>
                                                            </ui:ExecuteQuery.Parameters>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:ExecuteQuery>
                                                          <FlowStep.Next>
                                                            <FlowDecision x:Name="__ReferenceID5" Condition="[TabeldinDB.Rows.Count &lt;&gt; 1]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_292">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <av:Point x:Key="ShapeLocation">320.5,986.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                                  <av:PointCollection x:Key="TrueConnector">320.5,1030 281,1030</av:PointCollection>
                                                                  <av:PointCollection x:Key="FalseConnector">399.5,1030 511,1030 511,1140 481,1140</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <FlowDecision.True>
                                                                <FlowStep x:Name="__ReferenceID4" sap2010:WorkflowViewState.IdRef="FlowStep_1161">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">19,1000</av:Point>
                                                                      <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1362">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </FlowStep>
                                                              </FlowDecision.True>
                                                              <FlowDecision.False>
                                                                <FlowStep x:Name="__ReferenceID7" sap2010:WorkflowViewState.IdRef="FlowStep_1168">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">219,1110</av:Point>
                                                                      <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">350,1170 350,1220</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1363">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[idDosar]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[TabeldinDB.Rows.Item(0).Item(0).ToString]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <FlowStep.Next>
                                                                    <FlowStep x:Name="__ReferenceID13" sap2010:WorkflowViewState.IdRef="FlowStep_1184">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">250,1220</av:Point>
                                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">350,1272 350,1321</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <If Condition="[ScanPartial = &quot;&quot;]" DisplayName="Compune InterogSQL-ScanPartial" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_512">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <If.Then>
                                                                          <Assign DisplayName="Cu dbo.Attachment.AttachmentId" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1375">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">["SELECT TOP 1 dbo.Document.id_document, dbo.Document.data, dbo.Document.id_tipdocument, dbo.Attachment.AttachmentId FROM Document LEFT JOIN dbo.Attachment ON dbo.Attachment.DocumentId = dbo.Document.id_document WHERE id_dosar=@idDosar"]</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <Assign DisplayName="Fara dbo.Attachment.AttachmentId" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1376">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">["SELECT TOP 1 dbo.Document.id_document, dbo.Document.data, dbo.Document.id_tipdocument FROM Document WHERE id_dosar=@idDosar"]</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                        </If.Else>
                                                                      </If>
                                                                      <FlowStep.Next>
                                                                        <FlowStep x:Name="__ReferenceID14" sap2010:WorkflowViewState.IdRef="FlowStep_1183">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">250,1321</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">350,1373 350,1422</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If Condition="[DataDoc &lt;&gt; &quot;&quot;]" DisplayName="Compune InterogSQL-DataDoc" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_513">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <Assign DisplayName="Cu DataDoc" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1377">
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[InterogareSQL+" "+"AND day(data)=@DataDoc"]</InArgument>
                                                                                </Assign.Value>
                                                                              </Assign>
                                                                            </If.Then>
                                                                            <If.Else>
                                                                              <Assign DisplayName="Cu DataDoc" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1407">
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[InterogareSQL+" "+"AND data=CONVERT(date, GETDATE())"]</InArgument>
                                                                                </Assign.Value>
                                                                              </Assign>
                                                                            </If.Else>
                                                                          </If>
                                                                          <FlowStep.Next>
                                                                            <FlowStep x:Name="__ReferenceID15" sap2010:WorkflowViewState.IdRef="FlowStep_1182">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">250,1422</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">350,1474 350,1523</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If Condition="[Diez = &quot;&quot;]" DisplayName="Compune InterogSQL-Diez" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_514">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <Assign DisplayName="Fara Diez" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1378">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[InterogareSQL+" "+"AND (descriere IS NULL OR descriere NOT LIKE '%#%')"]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Assign DisplayName="Cu Diez" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1379">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[InterogareSQL+" "+"AND (descriere LIKE ('%'+@Diez) OR descriere LIKE ('%'+@Diez+'[^0-9]%'))"]</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Else>
                                                                              </If>
                                                                              <FlowStep.Next>
                                                                                <FlowStep x:Name="__ReferenceID16" sap2010:WorkflowViewState.IdRef="FlowStep_1181">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">250,1523</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">350,1574 350,1624</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If Condition="[ScanPartial = &quot;&quot;]" DisplayName="Compune InterogSQL-partea finala" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_515">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If.Then>
                                                                                      <Assign DisplayName="Cu dbo.Attachment.AttachmentId" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1380">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[InterogareSQL+" "+"AND dbo.Attachment.AttachmentId IS NULL AND id_tipdocument NOT IN (" + instanta("TipDocExcluse") + ") ORDER BY data DESC, id_document ASC"]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </If.Then>
                                                                                    <If.Else>
                                                                                      <Assign DisplayName="Fara dbo.Attachment.AttachmentId" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1381">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[InterogareSQL+" "+"AND id_tipdocument NOT IN (" + instanta("TipDocExcluse") + ") ORDER BY data DESC, id_document ASC"]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </If.Else>
                                                                                  </If>
                                                                                  <FlowStep.Next>
                                                                                    <FlowStep x:Name="__ReferenceID3" sap2010:WorkflowViewState.IdRef="FlowStep_1166">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <av:Point x:Key="ShapeLocation">250,1624</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                          <av:PointCollection x:Key="ConnectorLocation">350,1676 350,1736.5</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query InterogareSQL" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_225" ProviderName="System.Data.SqlClient" Sql="[InterogareSQL]" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                        <ui:ExecuteQuery.Parameters>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="idDosar">[idDosar]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="Diez">[Diez]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="DataDoc">[DataDoc]</InArgument>
                                                                                        </ui:ExecuteQuery.Parameters>
                                                                                      </ui:ExecuteQuery>
                                                                                      <FlowStep.Next>
                                                                                        <FlowDecision x:Name="__ReferenceID2" Condition="[TabeldinDB.Rows.Count = 0]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_288">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <av:Point x:Key="ShapeLocation">310.5,1736.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                                                              <av:PointCollection x:Key="TrueConnector">310.5,1780 272,1780</av:PointCollection>
                                                                                              <av:PointCollection x:Key="FalseConnector">389.5,1780 439,1780</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <FlowDecision.True>
                                                                                            <FlowStep x:Name="__ReferenceID1" sap2010:WorkflowViewState.IdRef="FlowStep_1162">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <av:Point x:Key="ShapeLocation">10,1750</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1364">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[idDocument]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                            </FlowStep>
                                                                                          </FlowDecision.True>
                                                                                          <FlowDecision.False>
                                                                                            <FlowStep x:Name="__ReferenceID0" sap2010:WorkflowViewState.IdRef="FlowStep_1163">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <av:Point x:Key="ShapeLocation">439,1750</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1365">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[idDocument]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[TabeldinDB.Rows.Item(0).Item(0).ToString]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                            </FlowStep>
                                                                                          </FlowDecision.False>
                                                                                        </FlowDecision>
                                                                                      </FlowStep.Next>
                                                                                    </FlowStep>
                                                                                  </FlowStep.Next>
                                                                                </FlowStep>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowDecision.False>
                                                            </FlowDecision>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowStep.Next>
                                </FlowStep>
                                <x:Reference>__ReferenceID0</x:Reference>
                                <x:Reference>__ReferenceID1</x:Reference>
                                <x:Reference>__ReferenceID2</x:Reference>
                                <x:Reference>__ReferenceID3</x:Reference>
                                <x:Reference>__ReferenceID4</x:Reference>
                                <x:Reference>__ReferenceID5</x:Reference>
                                <x:Reference>__ReferenceID6</x:Reference>
                                <x:Reference>__ReferenceID7</x:Reference>
                                <x:Reference>__ReferenceID8</x:Reference>
                                <FlowStep x:Name="__ReferenceID18" sap2010:WorkflowViewState.IdRef="FlowStep_1180">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">260,124</av:Point>
                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">360,190 360,220 359.895,220 359.895,227.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Sequence DisplayName="Initializare variabile" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1550">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1353">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[idDosar]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1354">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[idDocument]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1355">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[Diez]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1356">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[DataDoc]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1371">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[ScanPartial]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1382">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[InterogareSQL]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1384">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Int32">[contorAtasamente]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </Sequence>
                                  <FlowStep.Next>
                                    <x:Reference>__ReferenceID9</x:Reference>
                                  </FlowStep.Next>
                                </FlowStep>
                                <x:Reference>__ReferenceID10</x:Reference>
                                <x:Reference>__ReferenceID11</x:Reference>
                                <x:Reference>__ReferenceID12</x:Reference>
                                <x:Reference>__ReferenceID13</x:Reference>
                                <x:Reference>__ReferenceID14</x:Reference>
                                <x:Reference>__ReferenceID15</x:Reference>
                                <x:Reference>__ReferenceID16</x:Reference>
                                <x:Reference>__ReferenceID17</x:Reference>
                              </Flowchart>
                              <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="262,61" sap2010:WorkflowViewState.IdRef="WriteLine_197" Text="[&quot;NrDosar &quot;+NrDosar+&quot; idDosar &quot;+idDosar + &quot; idDocument &quot;+ idDocument+&quot; &quot;+Diez+&quot;  &quot;+DataDoc+&quot; &quot;+file]" />
                              <If Condition="[NrDosar = &quot;nuamgasit&quot;]" DisplayName="Daca nu am gasit NrDosar" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_436">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="242,580" sap2010:WorkflowViewState.IdRef="Sequence_1393">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If sap2010:Annotation.AnnotationText="Muta fisierul in FolderErori, redenumit cu _mutat_ora_hh_mm, daca exista deja un fisier cu acelasi nume, pentru a evita suprascrierea" Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="If_478">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_103" Overwrite="True" Path="[file]" />
                                      </If.Then>
                                      <If.Else>
                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_94" Overwrite="True" Path="[file]" />
                                      </If.Else>
                                    </If>
                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_187" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am gasit dosarul in Ecris - EROARE&quot;]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:AppendLine>
                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_296">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_287" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                          <ui:BrowserScope.Body>
                                            <ActivityAction x:TypeArguments="x:Object">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1719">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_28" />
                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_713" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                  <ui:TypeInto.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                  </ui:TypeInto.Target>
                                                </ui:TypeInto>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:BrowserScope.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:BrowserScope>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_305">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_285" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                              <ui:OpenBrowser.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1720">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_714" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:OpenBrowser.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:OpenBrowser>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_320">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_3" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 2, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                          <ui:ExecuteNonQuery.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                          </ui:ExecuteNonQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteNonQuery>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_329">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_65" />
                                  </Sequence>
                                </If.Then>
                              </If>
                              <If Condition="[idDocument = &quot;nuamgasit&quot;]" DisplayName="Daca nu am gasit idDocument" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_437">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_1397">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_479">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_104" Overwrite="True" Path="[file]" />
                                      </If.Then>
                                      <If.Else>
                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_105" Overwrite="True" Path="[file]" />
                                      </If.Else>
                                    </If>
                                    <If Condition="[ScanPartial = &quot;&quot;]" DisplayName="Daca e scan partial - Append in log" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_542">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_188" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am gasit documentul (care nu trebuie sa aiba alte fisiere atasate) in Ecris la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez + &quot; - EROARE&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:AppendLine>
                                      </If.Then>
                                      <If.Else>
                                        <ui:AppendLine DisplayName="Append in log - scan partial" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_223" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am gasit documentul in Ecris la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez + &quot; - EROARE&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:AppendLine>
                                      </If.Else>
                                    </If>
                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_297">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_288" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                          <ui:BrowserScope.Body>
                                            <ActivityAction x:TypeArguments="x:Object">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1721">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_29" />
                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_715" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                  <ui:TypeInto.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                  </ui:TypeInto.Target>
                                                </ui:TypeInto>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:BrowserScope.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:BrowserScope>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_306">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_286" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                              <ui:OpenBrowser.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1722">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_716" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:OpenBrowser.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:OpenBrowser>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_321">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_4" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 3, '', '&quot;+idDosar+&quot;', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                          <ui:ExecuteNonQuery.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                          </ui:ExecuteNonQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteNonQuery>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_330">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_66" />
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <Sequence sap2010:Annotation.AnnotationText="Daca am gasit idDocument, numara cate atasamente exista deja la acel idDocument, pentru a putea verifica ulterior daca contorAtasamente s-a incrementat cu 1, adica urcarea documentului curent in Ecris a avut succes. Daca se foloseste p (ScanPartial), pot fi mai multe atasamente deja urcate la acelasi idDocument" sap:VirtualizedContainerService.HintSize="376,382" sap2010:WorkflowViewState.IdRef="Sequence_1563">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query InterogareSQL" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_227" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(dbo.Attachment.AttachmentId) FROM dbo.Attachment WHERE DocumentId=@idDocument AND AttachmentName=@filename" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                      <ui:ExecuteQuery.Parameters>
                                        <InArgument x:TypeArguments="x:String" x:Key="idDocument">[idDocument]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="filename">[Path.GetFileName(file)]</InArgument>
                                      </ui:ExecuteQuery.Parameters>
                                    </ui:ExecuteQuery>
                                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1385">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Int32">[contorAtasamente]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Int32">[cint(TabeldinDB.Rows.Item(0).Item(0))]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </Sequence>
                                </If.Else>
                              </If>
                              <TryCatch sap2010:Annotation.AnnotationText="Procedura in care este operata aplicatia Ecris pentru urcare document" DisplayName="Atasare document PDF in Ecris" sap:VirtualizedContainerService.HintSize="262,108" sap2010:WorkflowViewState.IdRef="TryCatch_229">
                                <TryCatch.Variables>
                                  <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                </TryCatch.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <TryCatch.Try>
                                  <Sequence sap2010:Annotation.AnnotationText="Robotul se conecteaza la fereastra Chrome, acceseaza URL corespunzator in Ecris si urca fisierul. Robotul foloseste injectie Javascript si metoda WindowMessages pentru butonul Alege fisierul. Robotul aloca timp suficient pentru incarcarea unor pagini mai lente si verifica daca elementele de care are nevoie din noua pagina s-au incarcat." DisplayName="Atasare document" sap:VirtualizedContainerService.HintSize="200,273" sap2010:WorkflowViewState.IdRef="Sequence_1399">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="434,2193" sap2010:WorkflowViewState.IdRef="BrowserScope_219" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;" TimeoutMS="3000">
                                      <ui:BrowserScope.Body>
                                        <ActivityAction x:TypeArguments="x:Object">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                          </ActivityAction.Argument>
                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,2047" sap2010:WorkflowViewState.IdRef="Sequence_1398">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:NavigateTo Browser="{x:Null}" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="NavigateTo_63" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/dosar_documente.aspx?id_dosar=&quot;+idDosar+&quot;&amp;id_document=&quot;+idDocument+&quot;&amp;page=0&quot;]" />
                                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'A '" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_406" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                              <ui:Click.CursorPosition>
                                                <ui:CursorPosition OffsetX="37" OffsetY="5" Position="TopLeft" />
                                              </ui:Click.CursorPosition>
                                              <ui:Click.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="38cc8f0d75407ab107a48d0f2e3b885f" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl aaname='Ataşamente' parentid='aspnetForm' tag='A' /&gt;" TimeoutMS="10000" WaitForReady="INTERACTIVE" />
                                              </ui:Click.Target>
                                            </ui:Click>
                                            <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  ctl00_ContentPla...'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_66">
                                              <ui:UiElementExists.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="6db32ec1e039fc1b637f5e29adfcf4c4" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_btnUpload' tag='INPUT' /&gt;&lt;nav up='1' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_uxFileUpload' tag='INPUT' /&gt;" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                              </ui:UiElementExists.Target>
                                            </ui:UiElementExists>
                                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'INPUT  ctl00_ContentPla...'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_407" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                              <ui:Click.CursorPosition>
                                                <ui:CursorPosition Position="Center">
                                                  <ui:CursorPosition.OffsetX>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:CursorPosition.OffsetX>
                                                  <ui:CursorPosition.OffsetY>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:CursorPosition.OffsetY>
                                                </ui:CursorPosition>
                                              </ui:Click.CursorPosition>
                                              <ui:Click.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="6db32ec1e039fc1b637f5e29adfcf4c4" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_btnUpload' tag='INPUT' /&gt;&lt;nav up='1' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_uxFileUpload' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                              </ui:Click.Target>
                                            </ui:Click>
                                            <ui:UiElementExists DisplayName="Element Exists 'Explorer Pane'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_89">
                                              <ui:UiElementExists.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="563a8a640f6a046fa8eff6852d08f88d" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd aaname='Explorer Pane' cls='DirectUIHWND' /&gt;&lt;wnd ctrlid='1121' title='ShellView' /&gt;&lt;wnd aaname='Items View' cls='DirectUIHWND' /&gt;" TimeoutMS="60000" WaitForReady="COMPLETE" />
                                              </ui:UiElementExists.Target>
                                            </ui:UiElementExists>
                                            <If sap2010:Annotation.AnnotationText="Daca nu se deschide fereastra Open file, este o eroare Windows si se arunca o exceptie pentru a fi repornit browser-ul." Condition="[elementExists]" DisplayName="Daca nu se deschide fereastra Open file" sap:VirtualizedContainerService.HintSize="334,138" sap2010:WorkflowViewState.IdRef="If_551">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Else>
                                                <Throw Exception="[new Exception(&quot;Nu pot deschide fereastra Open file&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_1" />
                                              </If.Else>
                                            </If>
                                            <If sap2010:Annotation.AnnotationText="Este posibil ca documentul sa fi fost sters intre timp si atunci se mai incearca o data accesarea lui, dupa care se inchide fereastra Open file." Condition="[System.IO.File.Exists(file)]" DisplayName="Verifica daca mai exista documentul" sap:VirtualizedContainerService.HintSize="334,138" sap2010:WorkflowViewState.IdRef="If_529">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Else>
                                                <Sequence sap:VirtualizedContainerService.HintSize="563,708" sap2010:WorkflowViewState.IdRef="Sequence_1608">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Delay Duration="00:00:08" sap:VirtualizedContainerService.HintSize="521,22" sap2010:WorkflowViewState.IdRef="Delay_72" />
                                                  <If Condition="[System.IO.File.Exists(file)]" DisplayName="If" sap:VirtualizedContainerService.HintSize="521,554" sap2010:WorkflowViewState.IdRef="If_528">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Else>
                                                      <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="376,406" sap2010:WorkflowViewState.IdRef="Sequence_1607">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_436" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                          <ui:Click.CursorPosition>
                                                            <ui:CursorPosition Position="Center">
                                                              <ui:CursorPosition.OffsetX>
                                                                <InArgument x:TypeArguments="x:Int32" />
                                                              </ui:CursorPosition.OffsetX>
                                                              <ui:CursorPosition.OffsetY>
                                                                <InArgument x:TypeArguments="x:Int32" />
                                                              </ui:CursorPosition.OffsetY>
                                                            </ui:CursorPosition>
                                                          </ui:Click.CursorPosition>
                                                          <ui:Click.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                          </ui:Click.Target>
                                                        </ui:Click>
                                                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_437" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                          <ui:Click.CursorPosition>
                                                            <ui:CursorPosition Position="Center">
                                                              <ui:CursorPosition.OffsetX>
                                                                <InArgument x:TypeArguments="x:Int32" />
                                                              </ui:CursorPosition.OffsetX>
                                                              <ui:CursorPosition.OffsetY>
                                                                <InArgument x:TypeArguments="x:Int32" />
                                                              </ui:CursorPosition.OffsetY>
                                                            </ui:CursorPosition>
                                                          </ui:Click.CursorPosition>
                                                          <ui:Click.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="5000" WaitForReady="COMPLETE" />
                                                          </ui:Click.Target>
                                                        </ui:Click>
                                                        <ui:Continue sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Continue_86" />
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </Sequence>
                                              </If.Else>
                                            </If>
                                            <Sequence sap2010:Annotation.AnnotationText="Verifica daca fisierul nu a ramas blocat de sejda/java sau deschis de alt program. Robotul incearca sa il acceseze si captureaza eventualele erori. Pentru a evita bucle infinite, dupa 100 accesari (aprox. 100 sec), trece mai departe" DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="334,213" sap2010:WorkflowViewState.IdRef="Sequence_1756">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_1412">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <DoWhile DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="484,913" sap2010:WorkflowViewState.IdRef="DoWhile_3">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <DoWhile.Condition>[fileLocked = True And contor &lt; 100]</DoWhile.Condition>
                                                <TryCatch DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="438,751" sap2010:WorkflowViewState.IdRef="TryCatch_311">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="304,524" sap2010:WorkflowViewState.IdRef="Sequence_1754">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1413">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1414">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">[contor + 1]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1415">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(file, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_66" MethodName="Close">
                                                        <InvokeMethod.TargetObject>
                                                          <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                                        </InvokeMethod.TargetObject>
                                                      </InvokeMethod>
                                                    </Sequence>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_320">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="526,359" sap2010:WorkflowViewState.IdRef="Sequence_1755">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[exception.Message.Contains(&quot;being used by another process&quot;)]" DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_568">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1416">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                            </If.Then>
                                                          </If>
                                                          <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Delay_78" />
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                              </DoWhile>
                                            </Sequence>
                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" DisplayName="Type into 'Edit'" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_554" SendWindowMessages="False" SimulateType="True" Text="[file]">
                                              <ui:TypeInto.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="95cb594c87ca427e6a91c8b67fcc360d" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='1148' aaname='File name:' cls='Edit' /&gt;" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                              </ui:TypeInto.Target>
                                            </ui:TypeInto>
                                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_431" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                              <ui:Click.CursorPosition>
                                                <ui:CursorPosition Position="Center">
                                                  <ui:CursorPosition.OffsetX>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:CursorPosition.OffsetX>
                                                  <ui:CursorPosition.OffsetY>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:CursorPosition.OffsetY>
                                                </ui:CursorPosition>
                                              </ui:Click.CursorPosition>
                                              <ui:Click.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d3450c2340df1d07b9c4a205c3659b86" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='1' title='&amp;amp;Open' aaname='Open' cls='Button' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                              </ui:Click.Target>
                                            </ui:Click>
                                            <ui:UiElementExists DisplayName="Element Exists 'Explorer Pane'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_91">
                                              <ui:UiElementExists.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="563a8a640f6a046fa8eff6852d08f88d" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd aaname='Explorer Pane' cls='DirectUIHWND' /&gt;&lt;wnd ctrlid='1121' title='ShellView' /&gt;&lt;wnd aaname='Items View' cls='DirectUIHWND' /&gt;" TimeoutMS="300" WaitForReady="INTERACTIVE" />
                                              </ui:UiElementExists.Target>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:UiElementExists>
                                            <If Condition="[elementExists]" DisplayName="Daca nu s-a inchis inca fereastra Open file" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_561">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <ui:WaitUiElementVanish ContinueOnError="True" DisplayName="Wait Element Vanish" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="WaitUiElementVanish_1" WaitNotActive="False" WaitNotVisible="False">
                                                  <ui:WaitUiElementVanish.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="563a8a640f6a046fa8eff6852d08f88d" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd aaname='Explorer Pane' cls='DirectUIHWND' /&gt;&lt;wnd ctrlid='1121' title='ShellView' /&gt;&lt;wnd aaname='Items View' cls='DirectUIHWND' /&gt;" TimeoutMS="60000" WaitForReady="INTERACTIVE" />
                                                  </ui:WaitUiElementVanish.Target>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:WaitUiElementVanish>
                                              </If.Then>
                                            </If>
                                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'INPUT  ctl00_ContentPla...'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_409" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                              <ui:Click.CursorPosition>
                                                <ui:CursorPosition OffsetX="14" OffsetY="9" Position="TopLeft" />
                                              </ui:Click.CursorPosition>
                                              <ui:Click.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d543012d377b9b895f33ef7426730333" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_btnUpload' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                              </ui:Click.Target>
                                            </ui:Click>
                                          </Sequence>
                                        </ActivityAction>
                                      </ui:BrowserScope.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:BrowserScope>
                                  </Sequence>
                                </TryCatch.Try>
                                <TryCatch.Catches>
                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,1855" sap2010:WorkflowViewState.IdRef="Catch`1_238">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ActivityAction x:TypeArguments="s:Exception">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="Logheaza eroarea si redeschide Ecris" sap:VirtualizedContainerService.HintSize="242,1786" sap2010:WorkflowViewState.IdRef="Sequence_1409">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If sap2010:Annotation.AnnotationText="Daca nu se poate deschide fereastra Open file, ori sunt foarte multe instante offline, iar robotul nu reuseste maparea drive-urilor si are intarzieri mari (robotul lasa timp suficient pentru incarcarea instantelor si pentru a trece peste timeout-uri la mapari - aceasta eroare nu a mai aparut la autor de foarte mult timp), ori Chrome are probleme. Cea mai buna solutie este inchiderea Chrome, repornirea sa si logarea din nou in Ecris-urile tuturor instantelor." Condition="[exception.Message.Contains(&quot;Nu pot deschide fereastra Open file&quot;)]" DisplayName="Daca nu s-a putut deschide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,318" sap2010:WorkflowViewState.IdRef="If_554">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence sap:VirtualizedContainerService.HintSize="242,660" sap2010:WorkflowViewState.IdRef="Sequence_1708">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_231" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu pot deschide fereastra Open file in browser. Repornesc browser-ul si ma loghez din nou in Ecris-urile tuturor instantelor&quot;]">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:AppendLine>
                                              <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_298">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <TryCatch.Try>
                                                  <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_289" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                    <ui:BrowserScope.Body>
                                                      <ActivityAction x:TypeArguments="x:Object">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1723">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_30" />
                                                          <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_717" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                            <ui:TypeInto.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                            </ui:TypeInto.Target>
                                                          </ui:TypeInto>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:BrowserScope.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:BrowserScope>
                                                </TryCatch.Try>
                                                <TryCatch.Catches>
                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_307">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                      </ActivityAction.Argument>
                                                      <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_287" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                        <ui:OpenBrowser.Body>
                                                          <ActivityAction x:TypeArguments="x:Object">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1724">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_718" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                <ui:TypeInto.Target>
                                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                </ui:TypeInto.Target>
                                                              </ui:TypeInto>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:OpenBrowser.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:OpenBrowser>
                                                    </ActivityAction>
                                                  </Catch>
                                                </TryCatch.Catches>
                                              </TryCatch>
                                              <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_322">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <TryCatch.Try>
                                                  <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_26" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 18, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                    <ui:ExecuteNonQuery.Parameters>
                                                      <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                    </ui:ExecuteNonQuery.Parameters>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ExecuteNonQuery>
                                                </TryCatch.Try>
                                                <TryCatch.Catches>
                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_331">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                      </ActivityAction.Argument>
                                                    </ActivityAction>
                                                  </Catch>
                                                </TryCatch.Catches>
                                              </TryCatch>
                                              <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="Inchide procesele Chrome" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_112" Values="[System.Diagnostics.Process.GetProcesses()]">
                                                <ui:ForEach.Body>
                                                  <ActivityAction x:TypeArguments="sd:Process">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,332" sap2010:WorkflowViewState.IdRef="Sequence_1703">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[process.ProcessName.ToLower.Contains(&quot;chrome&quot;)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_552">
                                                        <If.Then>
                                                          <ui:KillProcess ProcessName="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_33" Process="[process]" />
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEach.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ForEach>
                                              <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Login Ecris fiecare instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_113" Values="[ConfigInstante]">
                                                <ui:ForEach.Body>
                                                  <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Login Ecris" sap:VirtualizedContainerService.HintSize="486,478" sap2010:WorkflowViewState.IdRef="Sequence_1706">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                                      </Sequence.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:UiElementExists DisplayName="Element Exists - check browser is open" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="464,106" sap2010:WorkflowViewState.IdRef="UiElementExists_86">
                                                        <ui:UiElementExists.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d2d3a449290d82e8f55c472d5b5def0c" Selector="&lt;html app='chrome.exe' /&gt;" TimeoutMS="1000" WaitForReady="INTERACTIVE" />
                                                        </ui:UiElementExists.Target>
                                                      </ui:UiElementExists>
                                                      <If Condition="[elementExists]" DisplayName="Daca browser is open" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_553">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_281" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                            <ui:BrowserScope.Body>
                                                              <ActivityAction x:TypeArguments="x:Object">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                </ActivityAction.Argument>
                                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_1704">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_80" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                                  <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_87">
                                                                    <ui:UiElementExists.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                    </ui:UiElementExists.Target>
                                                                  </ui:UiElementExists>
                                                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_698" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                    <ui:TypeInto.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                    </ui:TypeInto.Target>
                                                                  </ui:TypeInto>
                                                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_699" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                    <ui:TypeInto.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                    </ui:TypeInto.Target>
                                                                  </ui:TypeInto>
                                                                  <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_456" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                    <ui:Click.CursorPosition>
                                                                      <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                    </ui:Click.CursorPosition>
                                                                    <ui:Click.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                    </ui:Click.Target>
                                                                  </ui:Click>
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </ui:BrowserScope.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:BrowserScope>
                                                        </If.Then>
                                                        <If.Else>
                                                          <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser Ecris" Hidden="False" sap:VirtualizedContainerService.HintSize="414,823" sap2010:WorkflowViewState.IdRef="OpenBrowser_278" NewSession="False" Private="True" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]">
                                                            <ui:OpenBrowser.Body>
                                                              <ActivityAction x:TypeArguments="x:Object">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                </ActivityAction.Argument>
                                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,724" sap2010:WorkflowViewState.IdRef="Sequence_1705">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_88">
                                                                    <ui:UiElementExists.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                    </ui:UiElementExists.Target>
                                                                  </ui:UiElementExists>
                                                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_700" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                    <ui:TypeInto.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                    </ui:TypeInto.Target>
                                                                  </ui:TypeInto>
                                                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_701" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                    <ui:TypeInto.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                    </ui:TypeInto.Target>
                                                                  </ui:TypeInto>
                                                                  <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_457" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                    <ui:Click.CursorPosition>
                                                                      <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                    </ui:Click.CursorPosition>
                                                                    <ui:Click.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                    </ui:Click.Target>
                                                                  </ui:Click>
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </ui:OpenBrowser.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:OpenBrowser>
                                                        </If.Else>
                                                      </If>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEach.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ForEach>
                                              <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_279" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                <ui:OpenBrowser.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,188" sap2010:WorkflowViewState.IdRef="Sequence_1707">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="334,96" sap2010:WorkflowViewState.IdRef="TypeInto_702" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                        <ui:TypeInto.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" WaitForReady="COMPLETE">
                                                            <ui:Target.TimeoutMS>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:Target.TimeoutMS>
                                                          </ui:Target>
                                                        </ui:TypeInto.Target>
                                                      </ui:TypeInto>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:OpenBrowser.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:OpenBrowser>
                                              <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_94" />
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                        <Sequence sap2010:Annotation.AnnotationText="Aceasta eroare a aparut de cateva ori in cazul unor dosare foarte vechi (xxx/233/1986), iar solutia este mutarea in FolderErori pentru ca angajatii sa incerce o urcare manuala." DisplayName="Daca dosar foarte vechi si nu poate urca citatia" sap:VirtualizedContainerService.HintSize="200,183" sap2010:WorkflowViewState.IdRef="Sequence_1750">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:UiElementExists DisplayName="Element Exists 'DIV  ctl00_ContentPlace...'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_90">
                                            <ui:UiElementExists.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="e9c850cbca65acd9c9cbe5d2af41bb82" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl css-selector='body&amp;gt;div&amp;gt;h1' tag='H1' aaname='ERROARE ' innertext='ERROARE ' class='MesajEroare' /&gt;" TimeoutMS="200" WaitForReady="INTERACTIVE" />
                                            </ui:UiElementExists.Target>
                                          </ui:UiElementExists>
                                          <If Condition="[elementExists]" sap:VirtualizedContainerService.HintSize="484,626" sap2010:WorkflowViewState.IdRef="If_556">
                                            <If.Then>
                                              <Sequence DisplayName="Sequence" sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_1749">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_555">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_125" Overwrite="True" Path="[file]" />
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_126" Overwrite="True" Path="[file]" />
                                                  </If.Else>
                                                </If>
                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_232" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc documentul la dosarul nr. &quot; + NrDosar + &quot;. Dosarul este probabil foarte vechi si Ecris genereaza o eroare la accesarea paginii documentului - EROARE&quot;]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AppendLine>
                                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_310">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_301" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1747">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_42" />
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_741" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_319">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_299" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                          <ui:OpenBrowser.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1748">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_742" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:OpenBrowser.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:OpenBrowser>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_323">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_27" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 19, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                      <ui:ExecuteNonQuery.Parameters>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:ExecuteNonQuery.Parameters>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ExecuteNonQuery>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_332">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_95" />
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                        </Sequence>
                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_189" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc documentul in Ecris la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez +  &quot;. Probabil nu m-am putut conecta la Ecris. Voi incerca mai tarziu&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:AppendLine>
                                        <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_299">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_290" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                              <ui:BrowserScope.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1725">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_31" />
                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_719" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:BrowserScope.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:BrowserScope>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_308">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_288" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                  <ui:OpenBrowser.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1726">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_720" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:OpenBrowser.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:OpenBrowser>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                        <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_324">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_5" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 8, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                              <ui:ExecuteNonQuery.Parameters>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:ExecuteNonQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteNonQuery>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_333">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                        <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1609">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_438" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                            <ui:Click.CursorPosition>
                                              <ui:CursorPosition Position="Center">
                                                <ui:CursorPosition.OffsetX>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:CursorPosition.OffsetX>
                                                <ui:CursorPosition.OffsetY>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:CursorPosition.OffsetY>
                                              </ui:CursorPosition>
                                            </ui:Click.CursorPosition>
                                            <ui:Click.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                            </ui:Click.Target>
                                          </ui:Click>
                                          <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_439" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                            <ui:Click.CursorPosition>
                                              <ui:CursorPosition Position="Center">
                                                <ui:CursorPosition.OffsetX>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:CursorPosition.OffsetX>
                                                <ui:CursorPosition.OffsetY>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:CursorPosition.OffsetY>
                                              </ui:CursorPosition>
                                            </ui:Click.CursorPosition>
                                            <ui:Click.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                            </ui:Click.Target>
                                          </ui:Click>
                                        </Sequence>
                                        <Sequence sap2010:Annotation.AnnotationText="Verifica daca Ecris nu a dat eroare 404, un mesaj de eroare specific Ecris diferit de cel al browser-ului. In caz afirmativ, repeta procedura de logare in Ecris la instanta respectiva." DisplayName="Verifica eroarea 404" sap:VirtualizedContainerService.HintSize="200,183" sap2010:WorkflowViewState.IdRef="Sequence_1614">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:UiElementExists DisplayName="Element Exists '404'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,68" sap2010:WorkflowViewState.IdRef="UiElementExists_69">
                                            <ui:UiElementExists.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="&lt;html app='chrome.exe' title='*404*' /&gt;" TimeoutMS="500" WaitForReady="COMPLETE" />
                                            </ui:UiElementExists.Target>
                                          </ui:UiElementExists>
                                          <If Condition="[elementExists]" DisplayName="Daca a dat eroare 404" sap:VirtualizedContainerService.HintSize="484,626" sap2010:WorkflowViewState.IdRef="If_530">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_1613">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_215" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Eroarea de mai sus a fost cauzata de Ecris printr-un mesaj 404&quot;]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AppendLine>
                                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_300">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_291" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1727">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_32" />
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_721" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_309">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_289" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                          <ui:OpenBrowser.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1728">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_722" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:OpenBrowser.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:OpenBrowser>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_325">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_6" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 7, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                      <ui:ExecuteNonQuery.Parameters>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:ExecuteNonQuery.Parameters>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ExecuteNonQuery>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_334">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_265" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                  <ui:BrowserScope.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,791" sap2010:WorkflowViewState.IdRef="Sequence_1634">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="NavigateTo_73" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                        <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_72">
                                                          <ui:UiElementExists.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                          </ui:UiElementExists.Target>
                                                        </ui:UiElementExists>
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_660" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" WaitForReady="COMPLETE">
                                                              <ui:Target.TimeoutMS>
                                                                <InArgument x:TypeArguments="x:Int32" />
                                                              </ui:Target.TimeoutMS>
                                                            </ui:Target>
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_661" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="3000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                        <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_446" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                          <ui:Click.CursorPosition>
                                                            <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                          </ui:Click.CursorPosition>
                                                          <ui:Click.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="3000" WaitForReady="COMPLETE" />
                                                          </ui:Click.Target>
                                                        </ui:Click>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:BrowserScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:BrowserScope>
                                                <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_87" />
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                        </Sequence>
                                        <If sap2010:Annotation.AnnotationText="Dupa un timp de inactivitate, utilizatorul este automat delogat (signed out) din Ecris, caz in care robotul noteaza eroarea si incearca relogarea in Ecris-ul respectivei instante." Condition="[elementExists]" DisplayName="Verifica logged out of Ecris" sap:VirtualizedContainerService.HintSize="200,168" sap2010:WorkflowViewState.IdRef="If_531">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Else>
                                            <Sequence DisplayName="Verifica logged out of Ecris" sap:VirtualizedContainerService.HintSize="526,1010" sap2010:WorkflowViewState.IdRef="Sequence_1483">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:CloseWindow TimeoutMS="{x:Null}" UseWindow="{x:Null}" DisplayName="Close log window" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="CloseWindow_1" InformativeScreenshot="6aff76514b3612a61f867918adb0578f" Selector="[&quot;&lt;html app='chrome.exe' url='*&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)+&quot;*' /&gt;&quot;]" WaitForReady="COMPLETE">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:CloseWindow>
                                              <ui:UiElementExists DisplayName="Element Exists - check logged out of Ecris" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_52">
                                                <ui:UiElementExists.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d182e6e30fa371617c7903f91a2bceb5" Selector="&lt;html app='chrome.exe' title='*' /&gt;" TimeoutMS="3000" WaitForReady="INTERACTIVE" />
                                                </ui:UiElementExists.Target>
                                              </ui:UiElementExists>
                                              <If Condition="[elementExists]" DisplayName="Daca logged out of Ecris" sap:VirtualizedContainerService.HintSize="484,626" sap2010:WorkflowViewState.IdRef="If_471">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_1482">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_273" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,791" sap2010:WorkflowViewState.IdRef="Sequence_1674">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="NavigateTo_77" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                            <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_81">
                                                              <ui:UiElementExists.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                              </ui:UiElementExists.Target>
                                                            </ui:UiElementExists>
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_680" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_681" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                            <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_452" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                              <ui:Click.CursorPosition>
                                                                <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                              </ui:Click.CursorPosition>
                                                              <ui:Click.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                              </ui:Click.Target>
                                                            </ui:Click>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_216" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Am procedat la logarea din nou in Ecris-ul acestei instante&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_259" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,188" sap2010:WorkflowViewState.IdRef="Sequence_1605">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="334,96" sap2010:WorkflowViewState.IdRef="TypeInto_648" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" WaitForReady="COMPLETE">
                                                                  <ui:Target.TimeoutMS>
                                                                    <InArgument x:TypeArguments="x:Int32" />
                                                                  </ui:Target.TimeoutMS>
                                                                </ui:Target>
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_326">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_7" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 4, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_335">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_71" />
                                                  </Sequence>
                                                </If.Then>
                                              </If>
                                            </Sequence>
                                          </If.Else>
                                        </If>
                                        <If sap2010:Annotation.AnnotationText="Uneori serverul Ecris nu raspunde sau browser-ul a fost inchis de utilizator si robotul nu se poate conecta. In aceste cazuri, robotul verifica daca IP Ecris este online. In caz negativ, instanta este marcata offline pentru a fi sarita 5 minute si se trimite email administratorului. In caz contrar, se presupune ca browser-ul este inchis, se redeschide browser-ul si se logheaza din nou in Ecris-urile tuturor instantelor." Condition="[elementExists]" DisplayName="Verifica server unreachable" sap:VirtualizedContainerService.HintSize="484,301" sap2010:WorkflowViewState.IdRef="If_517">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Else>
                                            <Sequence DisplayName="Verifica server unreachable" sap:VirtualizedContainerService.HintSize="633,1062" sap2010:WorkflowViewState.IdRef="Sequence_1490">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="x:Int32" Name="statusCode" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign DisplayName="Initializare variabila" sap:VirtualizedContainerService.HintSize="591,60" sap2010:WorkflowViewState.IdRef="Assign_1323">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[statusCode]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <ui:HttpClient Body="{x:Null}" ClientCertificate="{x:Null}" ClientCertificatePassword="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseHeaders="{x:Null}" Result="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" BodyFormat="application/xml" ContinueOnError="True" DisplayName="Verifica server Ecris HTTP Request" EndPoint="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" sap:VirtualizedContainerService.HintSize="591,22" sap2010:WorkflowViewState.IdRef="HttpClient_1" Method="GET" StatusCode="[statusCode]" TimeoutMS="6000">
                                                <ui:HttpClient.Attachments>
                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                </ui:HttpClient.Attachments>
                                                <ui:HttpClient.Cookies>
                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                </ui:HttpClient.Cookies>
                                                <ui:HttpClient.Headers>
                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                </ui:HttpClient.Headers>
                                                <ui:HttpClient.Parameters>
                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                </ui:HttpClient.Parameters>
                                                <ui:HttpClient.UrlSegments>
                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                </ui:HttpClient.UrlSegments>
                                              </ui:HttpClient>
                                              <If Condition="[statusCode &lt;&gt; HttpStatusCode.OK]" DisplayName="Fie server Ecris unreachable, fie browser-ul e inchis" sap:VirtualizedContainerService.HintSize="591,808" sap2010:WorkflowViewState.IdRef="If_473">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence sap:VirtualizedContainerService.HintSize="304,578" sap2010:WorkflowViewState.IdRef="Sequence_1513">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_203" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Nu pot contacta serverul Ecris la adresa IP &quot;+instanta(&quot;IPecris&quot;)+&quot; HTTP StatusCode: &quot;+statusCode.ToString]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_301">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_292" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1729">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_33" />
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_723" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_310">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_290" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1730">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_724" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_327">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_8" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 6, '&quot;+&quot;Nu pot contacta serverul Ecris la adresa IP &quot;+instanta(&quot;IPecris&quot;)+&quot; HTTP StatusCode: &quot;+statusCode.ToString+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_336">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <If Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_490">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,282" sap2010:WorkflowViewState.IdRef="TryCatch_249">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <TryCatch.Try>
                                                            <InvokeMethod DisplayName="Send email Invoke method" sap:VirtualizedContainerService.HintSize="238,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_53" MethodName="Send">
                                                              <InvokeMethod.TargetObject>
                                                                <InArgument x:TypeArguments="snm:SmtpClient">[new SmtpClient(instanta("IPsmtp"), Convert.ToInt32(instanta("PortSmtp")))]</InArgument>
                                                              </InvokeMethod.TargetObject>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <InArgument x:TypeArguments="x:String">[instanta("EmailSenderRobot")]</InArgument>
                                                              <InArgument x:TypeArguments="x:String">[instanta("DestinatariEmailEroare")]</InArgument>
                                                              <InArgument x:TypeArguments="x:String">["["+ instanta("NumeInstanta").ToUpper +"] Robotul UiPath a intalnit o eroare"]</InArgument>
                                                              <InArgument x:TypeArguments="x:String">["["+ instanta("NumeInstanta").ToUpper +"] Robot UiPath - Eroare in procedura de urcare Documente scanate in Ecris. Nu pot contacta serverul Ecris la adresa IP "+instanta("IPecris")+" HTTP StatusCode: "+statusCode.ToString]</InArgument>
                                                            </InvokeMethod>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,120" sap2010:WorkflowViewState.IdRef="Catch`1_258">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_204" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Nu am putut trimite e-mail cu eroarea&quot;]">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:AppendLine>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                          <TryCatch.Finally>
                                                            <Assign DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1314">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </TryCatch.Finally>
                                                        </TryCatch>
                                                      </If.Then>
                                                    </If>
                                                    <Assign DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1315">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <ui:Break sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Break_3" />
                                                  </Sequence>
                                                </If.Then>
                                                <If.Else>
                                                  <Sequence sap:VirtualizedContainerService.HintSize="242,660" sap2010:WorkflowViewState.IdRef="Sequence_1489">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_217" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Cred ca browser-ul este inchis. Il repornesc si ma loghez din nou in Ecris-urile tuturor instantelor&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_302">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_293" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1731">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_34" />
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_725" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_311">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_291" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1732">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_726" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_328">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_9" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 5, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_337">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="Inchide procesele Chrome" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_101" Values="[System.Diagnostics.Process.GetProcesses()]">
                                                      <ui:ForEach.Body>
                                                        <ActivityAction x:TypeArguments="sd:Process">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,332" sap2010:WorkflowViewState.IdRef="Sequence_1484">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If Condition="[process.ProcessName.ToLower.Contains(&quot;chrome&quot;)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_472">
                                                              <If.Then>
                                                                <ui:KillProcess ProcessName="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_32" Process="[process]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:ForEach.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEach>
                                                    <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Login Ecris fiecare instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_109" Values="[ConfigInstante]">
                                                      <ui:ForEach.Body>
                                                        <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Login Ecris" sap:VirtualizedContainerService.HintSize="486,478" sap2010:WorkflowViewState.IdRef="Sequence_1677">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:UiElementExists DisplayName="Element Exists - check browser is open" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="464,106" sap2010:WorkflowViewState.IdRef="UiElementExists_82">
                                                              <ui:UiElementExists.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d2d3a449290d82e8f55c472d5b5def0c" Selector="&lt;html app='chrome.exe' /&gt;" TimeoutMS="1000" WaitForReady="INTERACTIVE" />
                                                              </ui:UiElementExists.Target>
                                                            </ui:UiElementExists>
                                                            <If Condition="[elementExists]" DisplayName="Daca browser is open" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_548">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_274" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                                  <ui:BrowserScope.Body>
                                                                    <ActivityAction x:TypeArguments="x:Object">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_1675">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_78" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                                        <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_83">
                                                                          <ui:UiElementExists.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                          </ui:UiElementExists.Target>
                                                                        </ui:UiElementExists>
                                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_682" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_683" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                        <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_453" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                          <ui:Click.CursorPosition>
                                                                            <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                          </ui:Click.CursorPosition>
                                                                          <ui:Click.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                          </ui:Click.Target>
                                                                        </ui:Click>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:BrowserScope.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:BrowserScope>
                                                              </If.Then>
                                                              <If.Else>
                                                                <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser Ecris" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_272" NewSession="False" Private="True" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]">
                                                                  <ui:OpenBrowser.Body>
                                                                    <ActivityAction x:TypeArguments="x:Object">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,724" sap2010:WorkflowViewState.IdRef="Sequence_1676">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_84">
                                                                          <ui:UiElementExists.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                          </ui:UiElementExists.Target>
                                                                        </ui:UiElementExists>
                                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_684" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_685" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                        <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_454" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                          <ui:Click.CursorPosition>
                                                                            <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                          </ui:Click.CursorPosition>
                                                                          <ui:Click.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                          </ui:Click.Target>
                                                                        </ui:Click>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:OpenBrowser.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:OpenBrowser>
                                                              </If.Else>
                                                            </If>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:ForEach.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEach>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_260" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,188" sap2010:WorkflowViewState.IdRef="Sequence_1606">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="334,96" sap2010:WorkflowViewState.IdRef="TypeInto_649" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" WaitForReady="COMPLETE">
                                                                  <ui:Target.TimeoutMS>
                                                                    <InArgument x:TypeArguments="x:Int32" />
                                                                  </ui:Target.TimeoutMS>
                                                                </ui:Target>
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_81" />
                                                  </Sequence>
                                                </If.Else>
                                              </If>
                                            </Sequence>
                                          </If.Else>
                                        </If>
                                      </Sequence>
                                    </ActivityAction>
                                  </Catch>
                                </TryCatch.Catches>
                                <TryCatch.Finally>
                                  <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_65" />
                                </TryCatch.Finally>
                              </TryCatch>
                              <Sequence sap2010:Annotation.AnnotationText="Verifica daca urcarea documentului a avut succes" DisplayName="Verifica urcarea documentului PDF" sap:VirtualizedContainerService.HintSize="262,108" sap2010:WorkflowViewState.IdRef="Sequence_1562">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Afla numarul actual de atasamente, pentru a il compara cu contorAtasamente" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query InterogareSQL" sap:VirtualizedContainerService.HintSize="716,130" sap2010:WorkflowViewState.IdRef="ExecuteQuery_226" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(dbo.Attachment.AttachmentId) FROM dbo.Attachment WHERE DocumentId=@idDocument AND AttachmentName=@filename" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                  <ui:ExecuteQuery.Parameters>
                                    <InArgument x:TypeArguments="x:String" x:Key="idDocument">[idDocument]</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="filename">[Path.GetFileName(file)]</InArgument>
                                  </ui:ExecuteQuery.Parameters>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:ExecuteQuery>
                                <If sap2010:Annotation.AnnotationText="Daca nu a crescut numarul curent de atasamente, asteapta un pic si mai incearca o data, poate upload-ul merge greu" Condition="[cint(TabeldinDB.Rows.Item(0).Item(0)) &lt;= contorAtasamente]" sap:VirtualizedContainerService.HintSize="716,432" sap2010:WorkflowViewState.IdRef="If_522">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence sap:VirtualizedContainerService.HintSize="376,242" sap2010:WorkflowViewState.IdRef="Sequence_1564">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Delay Duration="00:00:12" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Delay_70" />
                                      <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query InterogareSQL" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_228" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(dbo.Attachment.AttachmentId) FROM dbo.Attachment WHERE DocumentId=@idDocument AND AttachmentName=@filename" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                        <ui:ExecuteQuery.Parameters>
                                          <InArgument x:TypeArguments="x:String" x:Key="idDocument">[idDocument]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="filename">[Path.GetFileName(file)]</InArgument>
                                        </ui:ExecuteQuery.Parameters>
                                      </ui:ExecuteQuery>
                                    </Sequence>
                                  </If.Then>
                                </If>
                                <If Condition="[cint(TabeldinDB.Rows.Item(0).Item(0)) &lt;= contorAtasamente]" sap:VirtualizedContainerService.HintSize="716,1046" sap2010:WorkflowViewState.IdRef="If_538">
                                  <If.Then>
                                    <Sequence sap2010:Annotation.AnnotationText="Daca nu a crescut numarul de atasamente, verifica daca Ecris nu a dat eroare 404, un mesaj de eroare specific Ecris diferit de cel al browser-ului. In caz afirmativ, repeta procedura de logare in Ecris la instanta respectiva. Se va reincerca intr-un ciclu ulterior urcarea documentului." DisplayName="Verifica eroarea 404" sap:VirtualizedContainerService.HintSize="526,898" sap2010:WorkflowViewState.IdRef="Sequence_1640">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:UiElementExists DisplayName="Element Exists '404'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,68" sap2010:WorkflowViewState.IdRef="UiElementExists_73">
                                        <ui:UiElementExists.Target>
                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="&lt;html app='chrome.exe' title='*404*' /&gt;" TimeoutMS="500" WaitForReady="COMPLETE" />
                                        </ui:UiElementExists.Target>
                                      </ui:UiElementExists>
                                      <If Condition="[elementExists]" DisplayName="Daca a dat eroare 404" sap:VirtualizedContainerService.HintSize="484,626" sap2010:WorkflowViewState.IdRef="If_537">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_1639">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_221" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Eroarea de mai sus a fost cauzata de Ecris printr-un mesaj 404&quot;]">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:AppendLine>
                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_303">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_294" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                  <ui:BrowserScope.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1733">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_35" />
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_727" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:BrowserScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:BrowserScope>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_312">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_292" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1734">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_728" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_329">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_10" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 7, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                  <ui:ExecuteNonQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteNonQuery.Parameters>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ExecuteNonQuery>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_338">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_275" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                              <ui:BrowserScope.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,791" sap2010:WorkflowViewState.IdRef="Sequence_1678">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="NavigateTo_79" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                    <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_85">
                                                      <ui:UiElementExists.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                      </ui:UiElementExists.Target>
                                                    </ui:UiElementExists>
                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_686" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_687" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                    <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_455" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                      <ui:Click.CursorPosition>
                                                        <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                      </ui:Click.CursorPosition>
                                                      <ui:Click.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                      </ui:Click.Target>
                                                    </ui:Click>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:BrowserScope.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:BrowserScope>
                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_91" />
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </If.Then>
                                </If>
                                <If Condition="[cint(TabeldinDB.Rows.Item(0).Item(0)) &lt;= contorAtasamente]" sap:VirtualizedContainerService.HintSize="716,1084" sap2010:WorkflowViewState.IdRef="If_533">
                                  <If.Then>
                                    <Sequence sap2010:Annotation.AnnotationText="Daca nu a crescut numarul de atasamente, verifica daca in Ecris nu a aparut o eroare fisier de tip inexistent sau gresit. in acest caz, incearca sa inchida fereastra Open file, daca e deschisa. Se va reincerca intr-un ciclu ulterior urcarea documentului." sap:VirtualizedContainerService.HintSize="526,936" sap2010:WorkflowViewState.IdRef="Sequence_1622">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:UiElementExists DisplayName="Element Exists 'DIV  ctl00_ContentPlace...'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_70">
                                        <ui:UiElementExists.Target>
                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="58ecdcf05f8edead5eb252a41c25ec7f" Selector="&lt;html app='chrome.exe' title='ECRIS 2007 Courts [European Dynamics]' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_divError' tag='DIV' innertext='Se pot ataşa doar fişiere de tipul*' /&gt;" TimeoutMS="200" WaitForReady="INTERACTIVE" />
                                        </ui:UiElementExists.Target>
                                      </ui:UiElementExists>
                                      <If Condition="[elementExists]" sap:VirtualizedContainerService.HintSize="484,641" sap2010:WorkflowViewState.IdRef="If_532">
                                        <If.Then>
                                          <Sequence DisplayName="Daca mesaj fisier inexistent" sap:VirtualizedContainerService.HintSize="242,493" sap2010:WorkflowViewState.IdRef="Sequence_1621">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1623">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_440" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                <ui:Click.CursorPosition>
                                                  <ui:CursorPosition Position="Center">
                                                    <ui:CursorPosition.OffsetX>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetX>
                                                    <ui:CursorPosition.OffsetY>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetY>
                                                  </ui:CursorPosition>
                                                </ui:Click.CursorPosition>
                                                <ui:Click.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                </ui:Click.Target>
                                              </ui:Click>
                                              <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_441" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                <ui:Click.CursorPosition>
                                                  <ui:CursorPosition Position="Center">
                                                    <ui:CursorPosition.OffsetX>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetX>
                                                    <ui:CursorPosition.OffsetY>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetY>
                                                  </ui:CursorPosition>
                                                </ui:Click.CursorPosition>
                                                <ui:Click.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                </ui:Click.Target>
                                              </ui:Click>
                                            </Sequence>
                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_218" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Eroare fisier lipsa sau tip gresit fisier. Nu am reusit sa urc documentul la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez + &quot;. Voi incerca mai tarziu&quot;]">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:AppendLine>
                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_304">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_295" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                  <ui:BrowserScope.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1735">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_36" />
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_729" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:BrowserScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:BrowserScope>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_313">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_293" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1736">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_730" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_330">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_11" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 9, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                  <ui:ExecuteNonQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteNonQuery.Parameters>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ExecuteNonQuery>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_339">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_88" />
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </If.Then>
                                </If>
                                <If Condition="[cint(TabeldinDB.Rows.Item(0).Item(0)) &lt;= contorAtasamente]" sap:VirtualizedContainerService.HintSize="716,1175" sap2010:WorkflowViewState.IdRef="If_520">
                                  <If.Then>
                                    <Sequence sap2010:Annotation.AnnotationText="Daca nu a crescut numarul de atasamente, se verifica daca Ecris nu a dat eroare dimensiune invalida fisier. Pe ramura Else se inregistreaza orice alta posibil eroare. In ambele cazuri, eroarea se noteaza corespunzator in log, se inchide fereastra Open file si se muta fisierul in FolderErori." sap:VirtualizedContainerService.HintSize="571,1027" sap2010:WorkflowViewState.IdRef="Sequence_1561">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:UiElementExists DisplayName="Element Exists 'DIV  ctl00_ContentPlace...'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="529,106" sap2010:WorkflowViewState.IdRef="UiElementExists_71">
                                        <ui:UiElementExists.Target>
                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="93dd0a492797f1557da92c8eb208a6bc" Selector="&lt;html app='chrome.exe' title='ECRIS 2007 Courts [European Dynamics]' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_divError' tag='DIV' innertext='Dimensiunea fişierului nu este validă*' /&gt;" TimeoutMS="200" WaitForReady="INTERACTIVE" />
                                        </ui:UiElementExists.Target>
                                      </ui:UiElementExists>
                                      <If Condition="[elementExists]" sap:VirtualizedContainerService.HintSize="529,732" sap2010:WorkflowViewState.IdRef="If_536">
                                        <If.Then>
                                          <Sequence DisplayName="Daca mesaj depasire dimensiune upload" sap:VirtualizedContainerService.HintSize="242,584" sap2010:WorkflowViewState.IdRef="Sequence_1628">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1624">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_442" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                <ui:Click.CursorPosition>
                                                  <ui:CursorPosition Position="Center">
                                                    <ui:CursorPosition.OffsetX>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetX>
                                                    <ui:CursorPosition.OffsetY>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetY>
                                                  </ui:CursorPosition>
                                                </ui:Click.CursorPosition>
                                                <ui:Click.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                </ui:Click.Target>
                                              </ui:Click>
                                              <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_443" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                <ui:Click.CursorPosition>
                                                  <ui:CursorPosition Position="Center">
                                                    <ui:CursorPosition.OffsetX>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetX>
                                                    <ui:CursorPosition.OffsetY>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetY>
                                                  </ui:CursorPosition>
                                                </ui:Click.CursorPosition>
                                                <ui:Click.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                </ui:Click.Target>
                                              </ui:Click>
                                            </Sequence>
                                            <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_534">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_115" Overwrite="True" Path="[file]" />
                                              </If.Then>
                                              <If.Else>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_116" Overwrite="True" Path="[file]" />
                                              </If.Else>
                                            </If>
                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_219" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc documentul la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez + &quot;. Fisierul este mai mare decat limita maxima pentru upload permisa de Ecris - EROARE&quot;]">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:AppendLine>
                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_305">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_296" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                  <ui:BrowserScope.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1737">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_37" />
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_731" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:BrowserScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:BrowserScope>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_314">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_294" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1738">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_732" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_331">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_12" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 10, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                  <ui:ExecuteNonQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteNonQuery.Parameters>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ExecuteNonQuery>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_340">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_89" />
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence DisplayName="Daca alt mesaj de eroare" sap:VirtualizedContainerService.HintSize="242,584" sap2010:WorkflowViewState.IdRef="Sequence_1633">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1629">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_444" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                <ui:Click.CursorPosition>
                                                  <ui:CursorPosition Position="Center">
                                                    <ui:CursorPosition.OffsetX>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetX>
                                                    <ui:CursorPosition.OffsetY>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetY>
                                                  </ui:CursorPosition>
                                                </ui:Click.CursorPosition>
                                                <ui:Click.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                </ui:Click.Target>
                                              </ui:Click>
                                              <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_445" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                <ui:Click.CursorPosition>
                                                  <ui:CursorPosition Position="Center">
                                                    <ui:CursorPosition.OffsetX>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetX>
                                                    <ui:CursorPosition.OffsetY>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:CursorPosition.OffsetY>
                                                  </ui:CursorPosition>
                                                </ui:Click.CursorPosition>
                                                <ui:Click.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                </ui:Click.Target>
                                              </ui:Click>
                                            </Sequence>
                                            <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_535">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_117" Overwrite="True" Path="[file]" />
                                              </If.Then>
                                              <If.Else>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_118" Overwrite="True" Path="[file]" />
                                              </If.Else>
                                            </If>
                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_220" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc documentul la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez + &quot;. A aparut o eroare la operarea Ecris - EROARE&quot;]">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:AppendLine>
                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_306">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_297" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                  <ui:BrowserScope.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1739">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_38" />
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_733" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:BrowserScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:BrowserScope>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_315">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_295" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1740">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_734" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_332">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_13" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 11, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                  <ui:ExecuteNonQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteNonQuery.Parameters>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ExecuteNonQuery>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_341">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_90" />
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                  </If.Then>
                                </If>
                              </Sequence>
                              <TryCatch sap2010:Annotation.AnnotationText="Muta fisierul in FolderErori, redenumit cu _mutat_ora_hh_mm, daca exista deja un fisier cu acelasi nume, pentru a evita suprascrierea" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="262,153" sap2010:WorkflowViewState.IdRef="TryCatch_282">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <TryCatch.Try>
                                  <If Condition="[System.IO.File.Exists(instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_543">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Prelucrate redenumit" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_121" Overwrite="True" Path="[file]" />
                                    </If.Then>
                                    <If.Else>
                                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_122" Overwrite="True" Path="[file]" />
                                    </If.Else>
                                  </If>
                                </TryCatch.Try>
                                <TryCatch.Catches>
                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,303" sap2010:WorkflowViewState.IdRef="Catch`1_291">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ActivityAction x:TypeArguments="s:Exception">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="Wait and move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_1653">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <DoWhile DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="DoWhile_2">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <DoWhile.Condition>[fileLocked = True]</DoWhile.Condition>
                                          <TryCatch DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="418,683" sap2010:WorkflowViewState.IdRef="TryCatch_281">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="264,456" sap2010:WorkflowViewState.IdRef="Sequence_1651">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1394">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1395">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(file, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_65" MethodName="Close">
                                                  <InvokeMethod.TargetObject>
                                                    <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                                  </InvokeMethod.TargetObject>
                                                </InvokeMethod>
                                              </Sequence>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_290">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Daca nu poate fi accesat" sap:VirtualizedContainerService.HintSize="264,243" sap2010:WorkflowViewState.IdRef="Sequence_1652">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1396">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="Delay_74" />
                                                  </Sequence>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                        </DoWhile>
                                        <If Condition="[System.IO.File.Exists(instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="813,305" sap2010:WorkflowViewState.IdRef="If_544">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Prelucrate redenumit" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_123" Overwrite="True" Path="[file]" />
                                          </If.Then>
                                          <If.Else>
                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_124" Overwrite="True" Path="[file]" />
                                          </If.Else>
                                        </If>
                                      </Sequence>
                                    </ActivityAction>
                                  </Catch>
                                </TryCatch.Catches>
                              </TryCatch>
                              <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_190" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Document urcat in Ecris la dosarul nr. &quot; + NrDosar + &quot; &quot; + Diez + &quot; - Succes.&quot;]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:AppendLine>
                              <TryCatch sap2010:Annotation.AnnotationText="Face refresh la pagina Chrome cu jurnalul, pentru a se vedea pe ecran ultima intrare introdusa" DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="TryCatch_307">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <TryCatch.Try>
                                  <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_298" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                    <ui:BrowserScope.Body>
                                      <ActivityAction x:TypeArguments="x:Object">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                        </ActivityAction.Argument>
                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1741">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_39" />
                                          <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_735" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                            <ui:TypeInto.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                            </ui:TypeInto.Target>
                                          </ui:TypeInto>
                                        </Sequence>
                                      </ActivityAction>
                                    </ui:BrowserScope.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:BrowserScope>
                                </TryCatch.Try>
                                <TryCatch.Catches>
                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_316">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ActivityAction x:TypeArguments="s:Exception">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                      </ActivityAction.Argument>
                                      <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_296" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                        <ui:OpenBrowser.Body>
                                          <ActivityAction x:TypeArguments="x:Object">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1742">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_736" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                <ui:TypeInto.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                </ui:TypeInto.Target>
                                              </ui:TypeInto>
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:OpenBrowser.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:OpenBrowser>
                                    </ActivityAction>
                                  </Catch>
                                </TryCatch.Catches>
                              </TryCatch>
                              <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_333">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <TryCatch.Try>
                                  <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_1" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+Diez+&quot;', '&quot;+DataDoc+&quot;', '&quot;+ScanPartial+&quot;', 1, '', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                    <ui:ExecuteNonQuery.Parameters>
                                      <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                    </ui:ExecuteNonQuery.Parameters>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ExecuteNonQuery>
                                </TryCatch.Try>
                                <TryCatch.Catches>
                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_342">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ActivityAction x:TypeArguments="s:Exception">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                      </ActivityAction.Argument>
                                    </ActivityAction>
                                  </Catch>
                                </TryCatch.Catches>
                              </TryCatch>
                              <Assign sap2010:Annotation.AnnotationText="Daca robotul a avut succes si instanta fusese marcata offline inainte, acum robotul o va marca online, deoarece si-a revenit" DisplayName="Marcheaza instanta ca online" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="Assign_1308">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">["nu="+DateTime.Now.ToString]</InArgument>
                                </Assign.Value>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </Assign>
                            </Sequence>
                          </ActivityAction>
                        </ui:ForEach.Body>
                      </ui:ForEach>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_242">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="526,66" sap2010:WorkflowViewState.IdRef="Sequence_1418">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If sap2010:Annotation.AnnotationText="Robotul noteaza eroarea in log si trimite email cu eroarea numai daca au trecut cel putin 12 ore de la ultimul email trimis, pentru a nu deranja" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Noteaza eroarea o data la x ore" sap:VirtualizedContainerService.HintSize="484,820" sap2010:WorkflowViewState.IdRef="If_486">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If.Then>
                              <Sequence sap:VirtualizedContainerService.HintSize="304,630" sap2010:WorkflowViewState.IdRef="Sequence_1664">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_191" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+Path.GetFileName(fisierEroare)+&quot; - Eroare in procedura de urcare Documente scanate in Ecris. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:AppendLine>
                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_308">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <TryCatch.Try>
                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_299" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                      <ui:BrowserScope.Body>
                                        <ActivityAction x:TypeArguments="x:Object">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                          </ActivityAction.Argument>
                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1743">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_40" />
                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_737" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                              <ui:TypeInto.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                              </ui:TypeInto.Target>
                                            </ui:TypeInto>
                                          </Sequence>
                                        </ActivityAction>
                                      </ui:BrowserScope.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:BrowserScope>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_317">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_297" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                          <ui:OpenBrowser.Body>
                                            <ActivityAction x:TypeArguments="x:Object">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1744">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_738" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                  <ui:TypeInto.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                  </ui:TypeInto.Target>
                                                </ui:TypeInto>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:OpenBrowser.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:OpenBrowser>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_334">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <TryCatch.Try>
                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_14" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+fisierEroare.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', '', 15, 'Eroare in procedura de urcare Documente scanate in Ecris. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                      <ui:ExecuteNonQuery.Parameters>
                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                      </ui:ExecuteNonQuery.Parameters>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ExecuteNonQuery>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_343">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                                <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay&lt;New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay&gt;New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea daca e zi lucratoare" sap:VirtualizedContainerService.HintSize="484,235" sap2010:WorkflowViewState.IdRef="If_559">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Else>
                                    <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,546" sap2010:WorkflowViewState.IdRef="TryCatch_246">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" sap2010:Annotation.AnnotationText="Trimite email cu detaliile exceptiei, inclusiv mesajul exceptiei" Body="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura de urcare Documente scanate in Ecris. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instanta(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="334,187" sap2010:WorkflowViewState.IdRef="SendMail_2" IsBodyHtml="False" Name="[instanta(&quot;EmailSenderRobot&quot;)]" Port="[cint(instanta(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instanta(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instanta(&quot;DestinatariEmailEroare&quot;)]">
                                          <ui:SendMail.Files>
                                            <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                          </ui:SendMail.Files>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:SendMail>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,384" sap2010:WorkflowViewState.IdRef="Catch`1_255">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <Sequence sap:VirtualizedContainerService.HintSize="376,315" sap2010:WorkflowViewState.IdRef="Sequence_1688">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_227" Text="Nu am putut trimite e-mail cu eroarea" />
                                              <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_335">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <TryCatch.Try>
                                                  <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_22" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', '', 13, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                    <ui:ExecuteNonQuery.Parameters>
                                                      <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                    </ui:ExecuteNonQuery.Parameters>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ExecuteNonQuery>
                                                </TryCatch.Try>
                                                <TryCatch.Catches>
                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_344">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                      </ActivityAction.Argument>
                                                    </ActivityAction>
                                                  </Catch>
                                                </TryCatch.Catches>
                                              </TryCatch>
                                            </Sequence>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                  </If.Else>
                                </If>
                                <Assign sap2010:Annotation.AnnotationText="Noteaza in dictionar data si ora ultimului email trimis pentru instanta respectiva" DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1403">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                  </Assign.Value>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </Assign>
                              </Sequence>
                            </If.Then>
                          </If>
                          <Assign sap2010:Annotation.AnnotationText="Pentru a sari 5 min instanta, in variabila instanta(&quot;Offline&quot;) se noteaza data si ora erorii" DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="484,117" sap2010:WorkflowViewState.IdRef="Assign_1304">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                            </Assign.Value>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Assign>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </FlowStep>
              <FlowStep x:Name="__ReferenceID20" sap2010:WorkflowViewState.IdRef="FlowStep_1135">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">200,127.5</av:Point>
                    <av:Size x:Key="ShapeSize">200,198</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">300,325.5 300,384.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If sap2010:Annotation.AnnotationText="Daca instanta a dat eroare, robotul sare instanta timp de 5 minute, pentru a-i da posibilitatea sa revina online si a evita intarzierile provocate de timeout-uri. Pentru a tine minte eroarea, in variabila instanta(&quot;Offline&quot;) se scrie data si ora erorii" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;Offline&quot;).Split(&quot;=&quot;c)(1))).TotalMinutes &lt;= 5]" DisplayName="Sari 5' daca instanta e offline" sap:VirtualizedContainerService.HintSize="200,198" sap2010:WorkflowViewState.IdRef="If_489">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_74" />
                  </If.Then>
                </If>
                <FlowStep.Next>
                  <x:Reference>__ReferenceID19</x:Reference>
                </FlowStep.Next>
              </FlowStep>
            </Flowchart>
          </ActivityAction>
        </ui:ForEach.Body>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </ui:ForEach>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID23" sap2010:WorkflowViewState.IdRef="FlowStep_1137">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">190,499</av:Point>
              <av:Size x:Key="ShapeSize">200,79</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">190,538.5 141,538.5 141,459.04</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Delay sap2010:Annotation.AnnotationText="Asteapta 30 sec pentru a nu accesa prea mult harddisk-urile" Duration="00:00:30" sap:VirtualizedContainerService.HintSize="200,79" sap2010:WorkflowViewState.IdRef="Delay_68">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Delay>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID22" sap2010:WorkflowViewState.IdRef="FlowStep_1136">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">41,306.04</av:Point>
                  <av:Size x:Key="ShapeSize">200,153</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">241,382.54 361,382.54</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If sap2010:Annotation.AnnotationText="Sterge dimineata din share-uri fisierele mai vechi de un numar de zile si creeaza un fisier jurnal nou daca cel vechi este mai mare de 512 KB" Condition="[DateTime.Now.TimeOfDay &gt;= New TimeSpan(7, 30, 0) And DateTime.Now.TimeOfDay &lt;= New TimeSpan(7, 35, 0)]" DisplayName="Sterge fisiere vechi" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="If_498">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_1538">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Sterge fisierele mai vechi de un nr. de zile - FolderPrelucrate" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_105" Values="[ConfigInstante]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                          </ActivityAction.Argument>
                          <TryCatch DisplayName="Sterge fisierele vechi la instanta - FolderPrelucrate" sap:VirtualizedContainerService.HintSize="434,297" sap2010:WorkflowViewState.IdRef="TryCatch_258">
                            <TryCatch.Try>
                              <ui:ForEach x:TypeArguments="si:FileSystemInfo" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Sterge fisierele vechi din FolderPrelucrate si din FolderErori" DisplayName="For each file" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="ForEach`1_104" Values="[(New DirectoryInfo(instanta(&quot;FolderPrelucrate&quot;)).GetFileSystemInfos()).Concat(New DirectoryInfo(instanta(&quot;FolderErori&quot;)).GetFileSystemInfos())]">
                                <ui:ForEach.Body>
                                  <ActivityAction x:TypeArguments="si:FileSystemInfo">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="si:FileSystemInfo" Name="file" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="526,300" sap2010:WorkflowViewState.IdRef="Sequence_1531">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[(DateTime.Now - file.CreationTime).TotalDays &gt; Convert.ToInt32(instanta(&quot;ZilePastrare&quot;))]" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_495">
                                        <If.Then>
                                          <ui:Delete ContinueOnError="True" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_19" Path="[file.FullName]" />
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEach.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEach>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,135" sap2010:WorkflowViewState.IdRef="Catch`1_267">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="526,1069" sap2010:WorkflowViewState.IdRef="Sequence_1535">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If sap2010:Annotation.AnnotationText="Robotul noteaza eroarea in log si trimite email cu eroarea numai daca au trecut cel putin 12 ore de la ultimul email trimis, pentru a nu deranja" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Noteaza eroarea o data la x ore" sap:VirtualizedContainerService.HintSize="484,820" sap2010:WorkflowViewState.IdRef="If_496">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence sap:VirtualizedContainerService.HintSize="304,630" sap2010:WorkflowViewState.IdRef="Sequence_1665">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_209" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] Eroare in procedura de Stergere fisiere vechi. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:AppendLine>
                                          <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_309">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_300" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                <ui:BrowserScope.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1745">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_41" />
                                                      <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_739" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                        <ui:TypeInto.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                        </ui:TypeInto.Target>
                                                      </ui:TypeInto>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:BrowserScope.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:BrowserScope>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_318">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                  <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_298" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                    <ui:OpenBrowser.Body>
                                                      <ActivityAction x:TypeArguments="x:Object">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1746">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_740" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                            <ui:TypeInto.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                            </ui:TypeInto.Target>
                                                          </ui:TypeInto>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:OpenBrowser.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:OpenBrowser>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_336">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_15" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', '', 15, 'Eroare in procedura de Stergere fisiere vechi. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                <ui:ExecuteNonQuery.Parameters>
                                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                </ui:ExecuteNonQuery.Parameters>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExecuteNonQuery>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_345">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay&lt;New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay&gt;New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea daca e zi lucratoare" sap:VirtualizedContainerService.HintSize="484,235" sap2010:WorkflowViewState.IdRef="If_560">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Else>
                                              <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,546" sap2010:WorkflowViewState.IdRef="TryCatch_286">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <TryCatch.Try>
                                                  <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" sap2010:Annotation.AnnotationText="Trimite email cu detaliile exceptiei, inclusiv mesajul exceptiei" Body="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura Stergere fisiere vechi. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instanta(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="334,187" sap2010:WorkflowViewState.IdRef="SendMail_3" IsBodyHtml="False" Name="[instanta(&quot;EmailSenderRobot&quot;)]" Port="[cint(instanta(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instanta(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instanta(&quot;DestinatariEmailEroare&quot;)]">
                                                    <ui:SendMail.Files>
                                                      <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                    </ui:SendMail.Files>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:SendMail>
                                                </TryCatch.Try>
                                                <TryCatch.Catches>
                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,384" sap2010:WorkflowViewState.IdRef="Catch`1_295">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                      </ActivityAction.Argument>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="376,315" sap2010:WorkflowViewState.IdRef="Sequence_1689">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_228" Text="Nu am putut trimite e-mail cu eroarea" />
                                                        <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_337">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <TryCatch.Try>
                                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_23" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', '', 13, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                              <ui:ExecuteNonQuery.Parameters>
                                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                              </ui:ExecuteNonQuery.Parameters>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ExecuteNonQuery>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_346">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </Catch>
                                                </TryCatch.Catches>
                                              </TryCatch>
                                            </If.Else>
                                          </If>
                                          <Assign sap2010:Annotation.AnnotationText="Noteaza in dictionar data si ora ultimului email trimis pentru instanta respectiva" DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1404">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                            </Assign.Value>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Assign>
                                        </Sequence>
                                      </If.Then>
                                    </If>
                                    <Assign sap2010:Annotation.AnnotationText="Pentru a sari 5 min instanta, in variabila instanta(&quot;Offline&quot;) se noteaza data si ora erorii" DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="484,117" sap2010:WorkflowViewState.IdRef="Assign_1322">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                                      </Assign.Value>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </Assign>
                                  </Sequence>
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                          </TryCatch>
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                    <ui:ForEach x:TypeArguments="si:FileSystemInfo" CurrentIndex="{x:Null}" DisplayName="Log nou daca logul &gt; 512 KB - For each" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_106" Values="[New DirectoryInfo(Path.GetDirectoryName(ConfigGenerale(&quot;FisierLog&quot;))).GetFileSystemInfos(Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;)))]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="si:FileSystemInfo">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="si:FileSystemInfo" Name="file" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="526,536" sap2010:WorkflowViewState.IdRef="Sequence_1537">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If Condition="[new System.IO.FileInfo(file.FullName).Length &gt;= 524288]" sap:VirtualizedContainerService.HintSize="484,444" sap2010:WorkflowViewState.IdRef="If_497">
                              <If.Then>
                                <Sequence sap:VirtualizedContainerService.HintSize="242,296" sap2010:WorkflowViewState.IdRef="Sequence_1536">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:AppendLine DisplayName="Append in old log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_211" Text="[Environment.NewLine + &quot;Log inchis la &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;)]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:AppendLine>
                                  <ui:MoveFile ContinueOnError="True" Destination="[Path.GetDirectoryName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;\&quot;+Path.GetFileNameWithoutExtension(ConfigGenerale(&quot;FisierLog&quot;))+&quot;_pana_la_&quot;+DateTime.Now.ToString(&quot;dd-MM-yyyy_HH-mm&quot;)+Path.GetExtension(ConfigGenerale(&quot;FisierLog&quot;))]" DisplayName="Rename file" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_114" Overwrite="True" Path="[file.FullName]" />
                                  <ui:AppendLine DisplayName="Append in new log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_212" Text="[&quot;Log deschis la &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + Environment.NewLine]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:AppendLine>
                                </Sequence>
                              </If.Then>
                            </If>
                          </Sequence>
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                  </Sequence>
                </If.Then>
              </If>
              <FlowStep.Next>
                <x:Reference>__ReferenceID21</x:Reference>
              </FlowStep.Next>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <FlowStep x:Name="__ReferenceID24" sap2010:WorkflowViewState.IdRef="FlowStep_1133">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">361,135.04</av:Point>
          <av:Size x:Key="ShapeSize">200,123</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">461,258.04 461,336.04</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <TryCatch sap2010:Annotation.AnnotationText="Procedura in care robotul incarca setarile din baza de date si se logheaza in Ecris-urile instantelor" DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="TryCatch_219">
        <TryCatch.Variables>
          <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instantaExc" />
        </TryCatch.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <TryCatch.Try>
          <Sequence DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="376,1069" sap2010:WorkflowViewState.IdRef="Sequence_1371">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Robotul apeleaza un workflow separat care incarca setarile in baza de date si le pune la dispozitie astfel: dictionarul ConfigGenerale pentru setarile generale ale robotului si array-ul de dictionare ConfigInstanta, in care fiecare element din array corespunde unei instante si contine un dictionar cu setarile respectivei instante" DisplayName="Initializeaza setari" sap:VirtualizedContainerService.HintSize="334,189" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_6" UnSafe="False" WorkflowFileName="InitSetariMultiple.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)[]" x:Key="out_Config">[ConfigInstante]</OutArgument>
                <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="out_ConfigGenerale">[ConfigGenerale]</OutArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_InterogareSetariInstanta">SELECT * FROM `setari_instanta_doc` WHERE `InstantaActiva`='da'</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_InterogareSetariGenerale">SELECT * FROM `setari_generale_doc`</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_StringConectareMySQL">Dsn=roboti_mysql</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:InvokeWorkflowFile>
            <ui:AppendLine sap2010:Annotation.AnnotationText="Noteaza initializarea in fisierul jurnal. Robotul tine jurnalul in paralel in fisierul text si in baza de date" DisplayName="Noteaza initializarea in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="334,123" sap2010:WorkflowViewState.IdRef="AppendLine_179" Text="[Environment.NewLine + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot; Initializare&quot;]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:AppendLine>
            <TryCatch sap2010:Annotation.AnnotationText="Noteaza initializarea in baza de date jurnal." DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="438,314" sap2010:WorkflowViewState.IdRef="TryCatch_313">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <TryCatch.Try>
                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_18" ProviderName="System.Data.Odbc" Sql="INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('0', 'Initializare', NOW(), '', '', '', '', '', 16, '', '', '');" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                  <ui:ExecuteNonQuery.Parameters>
                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                  </ui:ExecuteNonQuery.Parameters>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ExecuteNonQuery>
              </TryCatch.Try>
              <TryCatch.Catches>
                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_322">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ActivityAction x:TypeArguments="s:Exception">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                    </ActivityAction.Argument>
                  </ActivityAction>
                </Catch>
              </TryCatch.Catches>
            </TryCatch>
            <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Robotul face curatenie dupa eventualele erori fatale anterioare si inchide toate procesele Chrome. Atentie la ferestrele pe care le aveti deschise. Robotul nu interactioneaza cu Internet Explorer sau cu alt browser." DisplayName="Inchide procesele Chrome" sap:VirtualizedContainerService.HintSize="334,183" sap2010:WorkflowViewState.IdRef="ForEach`1_88" Values="[System.Diagnostics.Process.GetProcesses()]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="sd:Process">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="526,300" sap2010:WorkflowViewState.IdRef="Sequence_1366">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If Condition="[process.ProcessName.ToLower.Contains(&quot;chrome&quot;)]" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_430">
                      <If.Then>
                        <ui:KillProcess ProcessName="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_29" Process="[process]" />
                      </If.Then>
                    </If>
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Initializeaza fiecare instanta" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ForEach`1_111" Values="[ConfigInstante]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Initializeaza instanta" sap:VirtualizedContainerService.HintSize="242,264" sap2010:WorkflowViewState.IdRef="Sequence_1663">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Sequence DisplayName="Pregatiri in caz de eroare" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1659">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap2010:Annotation.AnnotationText="Noteaza numele instantei care este la rand si care ar putea provoca erori" DisplayName="Assign" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1397">
                        <Assign.To>
                          <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">[instantaExc]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">[instanta]</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                      <Assign sap2010:Annotation.AnnotationText="Marcheaza instanta ca nemaifiind offline pana acum" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1398">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["nu="+DateTime.Now.ToString]</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                      <Assign sap2010:Annotation.AnnotationText="Initializeaza cu data ultimului email trimis administratorului (valoare de initializare)" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1399">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">1/1/2019 00:00:00</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                    </Sequence>
                    <Sequence DisplayName="Login Ecris" sap:VirtualizedContainerService.HintSize="526,494" sap2010:WorkflowViewState.IdRef="Sequence_1662">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:UiElementExists DisplayName="Element Exists - check browser is open" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_78">
                        <ui:UiElementExists.Target>
                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d2d3a449290d82e8f55c472d5b5def0c" Selector="&lt;html app='chrome.exe' /&gt;" TimeoutMS="1000" WaitForReady="INTERACTIVE" />
                        </ui:UiElementExists.Target>
                      </ui:UiElementExists>
                      <If Condition="[elementExists]" DisplayName="Daca browser is open" sap:VirtualizedContainerService.HintSize="484,256" sap2010:WorkflowViewState.IdRef="If_546">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Daca Chrome este deschis, se ataseaza la fereastra si introduce URL Ecris." BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="434,1105" sap2010:WorkflowViewState.IdRef="BrowserScope_270" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                            <ui:BrowserScope.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,932" sap2010:WorkflowViewState.IdRef="Sequence_1660">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="NavigateTo_76" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                  <ui:UiElementExists Exists="{x:Null}" sap2010:Annotation.AnnotationText="Acorda timp de asteptare in situatiile in care pagina Ecris se incarca greu" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="334,148" sap2010:WorkflowViewState.IdRef="UiElementExists_79">
                                    <ui:UiElementExists.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                    </ui:UiElementExists.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:UiElementExists>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" sap2010:Annotation.AnnotationText="Introduce numele de utilizator. Pentru majoritatea interactiunilor cu  browserul robotul foloseste injectie de Javascript." ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,191" sap2010:WorkflowViewState.IdRef="TypeInto_672" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:TypeInto>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_673" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                  <ui:Click DelayBefore="{x:Null}" sap2010:Annotation.AnnotationText="Robotul acorda timp dupa apasarea butonului pentru paginile care se incarca mai greu" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="334,148" sap2010:WorkflowViewState.IdRef="Click_450" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                    <ui:Click.CursorPosition>
                                      <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                    </ui:Click.CursorPosition>
                                    <ui:Click.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:Click.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:Click>
                                </Sequence>
                              </ActivityAction>
                            </ui:BrowserScope.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:BrowserScope>
                        </If.Then>
                        <If.Else>
                          <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Daca browserul nu e deschis, il deschide si introduce URL Ecris." BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser Ecris" Hidden="False" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="OpenBrowser_269" NewSession="False" Private="True" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]">
                            <ui:OpenBrowser.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,734" sap2010:WorkflowViewState.IdRef="Sequence_1661">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_80">
                                    <ui:UiElementExists.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                    </ui:UiElementExists.Target>
                                  </ui:UiElementExists>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_674" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_675" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                  <ui:Click DelayBefore="{x:Null}" sap2010:Annotation.AnnotationText="Robotul acorda timp dupa apasarea butonului pentru paginile care se incarca mai greu" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="334,148" sap2010:WorkflowViewState.IdRef="Click_451" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                    <ui:Click.CursorPosition>
                                      <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                    </ui:Click.CursorPosition>
                                    <ui:Click.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:Click.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:Click>
                                </Sequence>
                              </ActivityAction>
                            </ui:OpenBrowser.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:OpenBrowser>
                        </If.Else>
                      </If>
                    </Sequence>
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Robotul deschide fisierul log intr-o pagina speciala Chrome si simuleaza tasta End pentru a ajunge la linia cea mai recenta din log" BrowserType="Chrome" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="334,138" sap2010:WorkflowViewState.IdRef="OpenBrowser_214" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
              <ui:OpenBrowser.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,188" sap2010:WorkflowViewState.IdRef="Sequence_1370">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="334,96" sap2010:WorkflowViewState.IdRef="TypeInto_541" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                      <ui:TypeInto.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" WaitForReady="COMPLETE">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                        </ui:Target>
                      </ui:TypeInto.Target>
                    </ui:TypeInto>
                  </Sequence>
                </ActivityAction>
              </ui:OpenBrowser.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:OpenBrowser>
          </Sequence>
        </TryCatch.Try>
        <TryCatch.Catches>
          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_228">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ActivityAction x:TypeArguments="s:Exception">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
              </ActivityAction.Argument>
              <If sap2010:Annotation.AnnotationText="Robotul noteaza motivul erorii. Robotul procedeaza diferit in functie de cum eroarea intervenit inainte de incarcarea vreunei instante sau dupa" Condition="[IsNothing(instantaExc(&quot;NumeInstanta&quot;))]" DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="529,596" sap2010:WorkflowViewState.IdRef="If_549">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence DisplayName="Daca eroarea nu provine de la incarcarea vreunei instante" sap:VirtualizedContainerService.HintSize="242,397" sap2010:WorkflowViewState.IdRef="Sequence_1682">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_224" Text="[&quot;[&quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] Eroare in procedura de Initializare. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:AppendLine>
                    <TryCatch sap2010:Annotation.AnnotationText="Face refresh la pagina Chrome cu jurnalul pentru a se vedea pe ecran ultima intrare introdusa" DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="TryCatch_291">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_282" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                          <ui:BrowserScope.Body>
                            <ActivityAction x:TypeArguments="x:Object">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1709">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_23" />
                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_703" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                  <ui:TypeInto.Target>
                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                  </ui:TypeInto.Target>
                                </ui:TypeInto>
                              </Sequence>
                            </ActivityAction>
                          </ui:BrowserScope.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:BrowserScope>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_300">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_280" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                              <ui:OpenBrowser.Body>
                                <ActivityAction x:TypeArguments="x:Object">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1710">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_704" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                      <ui:TypeInto.Target>
                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                      </ui:TypeInto.Target>
                                    </ui:TypeInto>
                                  </Sequence>
                                </ActivityAction>
                              </ui:OpenBrowser.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:OpenBrowser>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_314">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_19" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('0', 'Initializare', NOW(), '', '', '', '', '', 15, 'Eroare in procedura de Initializare. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                          <ui:ExecuteNonQuery.Parameters>
                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                          </ui:ExecuteNonQuery.Parameters>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ExecuteNonQuery>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_323">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                  </Sequence>
                </If.Then>
                <If.Else>
                  <Sequence DisplayName="Daca eroarea provine de la incarcarea vreunei instante" sap:VirtualizedContainerService.HintSize="242,488" sap2010:WorkflowViewState.IdRef="Sequence_1687">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_225" Text="[&quot;[&quot;+ instantaExc(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] Eroare in procedura de Initializare. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:AppendLine>
                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_292">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_283" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                          <ui:BrowserScope.Body>
                            <ActivityAction x:TypeArguments="x:Object">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_1711">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_24" />
                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_705" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                  <ui:TypeInto.Target>
                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                  </ui:TypeInto.Target>
                                </ui:TypeInto>
                              </Sequence>
                            </ActivityAction>
                          </ui:BrowserScope.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:BrowserScope>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_301">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_281" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                              <ui:OpenBrowser.Body>
                                <ActivityAction x:TypeArguments="x:Object">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_1712">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_706" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                      <ui:TypeInto.Target>
                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                      </ui:TypeInto.Target>
                                    </ui:TypeInto>
                                  </Sequence>
                                </ActivityAction>
                              </ui:OpenBrowser.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:OpenBrowser>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_315">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_20" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instantaExc(&quot;id&quot;)+&quot;', '&quot;+instantaExc(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', '', 15, 'Eroare in procedura de Initializare. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '');&quot;]" TimeoutMS="1500" ConnectionString="Dsn=roboti_mysql">
                          <ui:ExecuteNonQuery.Parameters>
                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                          </ui:ExecuteNonQuery.Parameters>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ExecuteNonQuery>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_324">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                    <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay&lt;New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay&gt;New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea daca e zi lucratoare" sap:VirtualizedContainerService.HintSize="484,235" sap2010:WorkflowViewState.IdRef="If_558">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Else>
                        <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,546" sap2010:WorkflowViewState.IdRef="TryCatch_285">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch.Try>
                            <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" sap2010:Annotation.AnnotationText="Trimite email cu detaliile exceptiei, inclusiv mesajul exceptiei" Body="[&quot;[&quot;+ instantaExc(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura de Initializare. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instantaExc(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="334,187" sap2010:WorkflowViewState.IdRef="SendMail_1" IsBodyHtml="False" Name="[instantaExc(&quot;EmailSenderRobot&quot;)]" Port="[cint(instantaExc(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instantaExc(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instantaExc(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instantaExc(&quot;DestinatariEmailEroare&quot;)]">
                              <ui:SendMail.Files>
                                <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                              </ui:SendMail.Files>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:SendMail>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,384" sap2010:WorkflowViewState.IdRef="Catch`1_294">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Daca nu se poate trimite email" sap:VirtualizedContainerService.HintSize="376,315" sap2010:WorkflowViewState.IdRef="Sequence_1686">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_226" Text="Nu am putut trimite e-mail cu eroarea" />
                                  <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_316">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <TryCatch.Try>
                                      <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_21" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_doc` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `diez`, `data_doc`, `scan_partial`, `id_eroare`, `mesaj_special`, `id_dosar`, `id_document`) VALUES ('&quot;+instantaExc(&quot;id&quot;)+&quot;', '&quot;+instantaExc(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', '', 13, '', '', '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                        <ui:ExecuteNonQuery.Parameters>
                                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                        </ui:ExecuteNonQuery.Parameters>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ExecuteNonQuery>
                                    </TryCatch.Try>
                                    <TryCatch.Catches>
                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_325">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ActivityAction x:TypeArguments="s:Exception">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                          </ActivityAction.Argument>
                                        </ActivityAction>
                                      </Catch>
                                    </TryCatch.Catches>
                                  </TryCatch>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                        </TryCatch>
                      </If.Else>
                    </If>
                  </Sequence>
                </If.Else>
              </If>
            </ActivityAction>
          </Catch>
        </TryCatch.Catches>
      </TryCatch>
      <FlowStep.Next>
        <x:Reference>__ReferenceID21</x:Reference>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID22</x:Reference>
    <x:Reference>__ReferenceID23</x:Reference>
  </Flowchart>
</Activity>